
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fun√ß√µes Wiggly &#8212; Statistical Rethinking</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Statistical Rethinking</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Statistical Rethinking, notes in portuguese (üáßüá∑)
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Aula_1__Week_1.html">
   Statistical Rethinking
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Aula_2__week_4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rodolphomacedo/statistical_rethinking_pt_BR"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rodolphomacedo/statistical_rethinking_pt_BR/issues/new?title=Issue%20on%20page%20%2FAula_2__week_4.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rodolphomacedo/statistical_rethinking_pt_BR/main?urlpath=tree/Aula_2__week_4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mostrando-a-nossa-incerteza">
   Mostrando a nossa Incerteza
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construindo-a-distribuicao-preditiva-de-mu-i-dado-um-peso-especifico-x-i">
   Construindo a Distribui√ß√£o Preditiva de $\mu_i$ dado um peso espec√≠fico  $x_i$
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculando-a-predicao-para-todos-os-mu">
     Calculando a predi√ß√£o para todos os $\mu$
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curvas-a-partir-das-linhas-retas">
   Curvas a partir das Linhas Retas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regressao-polinomial">
   Regress√£o Polinomial
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelo-parabolico-da-altura">
     Modelo Parab√≥lico da Altura
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#padronizar-os-preditores">
     Padronizar os Preditores
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelos-cubicos">
     Modelos C√∫bicos
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dores-dos-polinomios">
     Dores dos Polin√¥mios
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#splines">
   Splines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agindo-localmente-b-splines">
   Agindo Localmente -
   <em>
    B-splines
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#festival-das-flores-de-cerejeira">
   Festival das Flores de Cerejeira
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-splines-do-clima">
     <em>
      B-splines
     </em>
     do Clima
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#como-as-splines-funcionam">
   Como as splines funcionam?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#knots-como-escolher-os-pontos">
     Knots - Como escolher os pontos?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#possibilidades-das-splines">
     Possibilidades das Splines
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="funcoes-wiggly">
<h1>Fun√ß√µes Wiggly<a class="headerlink" href="#funcoes-wiggly" title="Permalink to this headline">¬∂</a></h1>
<a class="reference internal image-reference" href="_images/cat_bow_tie.jpg"><img alt="_images/cat_bow_tie.jpg" src="_images/cat_bow_tie.jpg" style="width: 400px;" /></a>
<p>No cap√≠tulo anterior vimos como construir o nosso primeiro modelo de regress√£o linear, no qual estimamos a altura de uma pessoa usando a informa√ß√£o de seu peso como aux√≠lio. Temos assim, como resultado do nosso modelo, a distribui√ß√£o √† posteriori dos par√¢metros que foram estimados, $\alpha$, $\beta$ e o $\sigma$.</p>
<p>$$ altura_i = \alpha + \beta (peso_i - peso_medio) $$</p>
<p>Dessas distribui√ß√µes podemos pegar apenas os valores ‚Äúprecisos‚Äù desses par√¢mentros, ou seja, geralmente n√≥s tendemos pensar em pegar os valores esperados (<em>valores m√©dios</em>) da distribui√ß√£o do $\alpha$ e do $\beta$ e, com isso, tra√ßar uma linha reta com esses valores.</p>
<p>Olhando para os resultado das estimativas, quando o <strong>peso</strong> est√° em seu valor m√©dio, temos que $\alpha$ significa o valor m√©dio da altura!</p>
<p>Percebeu? Percebeu como isso √© muito bonito! Agora temos uma interpreta√ß√£o decente para o $\alpha$.</p>
<p>Agora, o que significa o nosso $\beta$? Temos que para cada unidade de $peso$ que aumentarmos a altura $h$ tamb√©m aumentar√° em $\beta$ unidades. Assim, para nosso exemplo, cada kilo que aumentamos a altura tende a aumentar, em m√©dia, $0.90$.</p>
<p>Mas sabemos que isso √© insuficiente, porque queremos obter a incerteza a partir desse gr√°fico. A estat√≠stica bayesiana n√£o lhe dar√° uma √∫nica estimativa pontual, mas sim, dar√° a sua incerteza, que √© comunicada a n√≥s pela distribui√ß√£o √† posteriori, que cont√©m <em>um n√∫mero infinito linhas</em>, e cada uma dessas linhas √© classificada pela sua plausibilidade relativa em compara√ß√£o todas as outras linhas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">stan</span>
<span class="kn">import</span> <span class="nn">nest_asyncio</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Desbloqueio do asyncIO do jupyter</span>
<span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definindo o plano de fundo cinza claro para todos os gr√°ficos feitos no matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lightgray&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lendo os dados</span>

<span class="c1"># OBS: A partir de agora irei definir as vari√°veis em Ingl√™s, </span>
<span class="c1">#        mas os coment√°rios continuar√£o no portuga para facilitar o entendimento.</span>

<span class="c1"># Os dados podem serem obtidos em https://github.com/rmcelreath/rethinking/tree/master/data/Howell1.csv</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Howell1.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>  

<span class="n">weight</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Filtro para pessoas com 30 anos ou mais </span>
<span class="n">height</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Filtro para pessoas com 30 anos ou mais</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_stan</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data {</span>
<span class="s2">        int N;</span>
<span class="s2">        vector[N] height;</span>
<span class="s2">        vector[N] weight;</span>
<span class="s2">    }</span>
<span class="s2">    </span>
<span class="s2">    parameters {</span>
<span class="s2">        real alpha;</span>
<span class="s2">        real beta;</span>
<span class="s2">        real&lt;lower=0, upper=50&gt; sigma;  // Priori impl√≠cita Uniforme(0, 50)</span>
<span class="s2">    }</span>
<span class="s2">    </span>
<span class="s2">    model {</span>
<span class="s2">        alpha ~ normal(178, 20);  // Priori para Alpha</span>
<span class="s2">        beta ~ lognormal(0, 1);  // Priori para Beta</span>
<span class="s2">        </span>
<span class="s2">        height ~ normal(alpha + beta * weight, sigma);</span>
<span class="s2">    }</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reescrevendo o modelo anterior - Estimativa da altura explicado com o peso.</span>

<span class="c1"># Lembrando que estamos usando o (x_i - x_barra)</span>
<span class="n">weight_adjust</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 

<span class="n">my_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">),</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_adjust</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">posteriori</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Recuperando os par√¢metros</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 3.3e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.33 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.7749, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.09268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -376.577, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -7.24979, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.02796, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.506776, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0595664, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0083974, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.495993, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.8072, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 5.6e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.56 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -12.1475, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -12.8253, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.31884, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -651.905, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -19.3477, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.162377, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.89916, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0322402, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0763243, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63297, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.95776, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.854652, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00379098, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0559983, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0383125, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.08948, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 7.7e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.77 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -91.3706, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.03354, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.138891, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.501545, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.5301, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.730819, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.47657, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0431793, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.52907, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 2.8e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.28 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.13715, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.84797, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0373841, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.19972, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.392525, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.570856, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00742766, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.298791, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.109211, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.48887, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Par√¢mentros</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori Alpha&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori Beta&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori Sigma&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_9_0.png" src="_images/Aula_2__week_4_9_0.png" />
</div>
</div>
<div class="section" id="mostrando-a-nossa-incerteza">
<h2>Mostrando a nossa Incerteza<a class="headerlink" href="#mostrando-a-nossa-incerteza" title="Permalink to this headline">¬∂</a></h2>
<p>Agora n√≥s iremos fazer uma amostragem das posterioris. Uma das raz√µes para usarmos esse procedimento de amostragem √© que isso se torna mais f√°cil de se pensar e, tamb√©m, esse procedimento pode ser aplicado a <strong>todos</strong> os tipos modelos que quisermos ajustar.</p>
<p>Nossa distribui√ß√£o √† posteriori cont√©m muitas linhas retas l√° dentro, representadas pela amostragem dos valores da distribui√ß√£o dos $\alpha$ e dos $\beta$ com o $\sigma$ informando o desvio padr√£o.</p>
<p>Abaixo vamos ver as primeiras linhas do conjunto de dados da estimativa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">beta</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">[:</span><span class="mi">10</span><span class="p">]}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        alpha      beta     sigma
0  154.511284  0.959106  5.376652
1  154.800100  0.948377  5.857236
2  154.573780  0.918115  4.901935
3  155.051443  0.830216  5.103433
4  154.693619  0.863708  4.894490
5  154.390728  0.884034  4.671267
6  154.482698  0.862897  5.258994
7  154.146444  0.998508  5.508650
8  155.085951  0.924640  4.901460
9  154.581396  0.880773  5.258939
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Para cada linha do conjunto de dados acima √© uma <code class="docutils literal notranslate"><span class="pre">linha</span> <span class="pre">reta</span></code>!</p></li>
</ul>
<p>Temos muitas linhas, e as linhas mais plaus√≠veis s√£o as linhas que tem maior n√∫mero de maneiras de reproduzir os dados que observamos. Essa plausabilidade √© aprensentada para n√≥s atrav√©s do maior ac√∫mulo de linhas retas que se sobrep√µem.</p>
<p>Aten√ß√£o: Quanto mais as linhas se sobreporem entre si em uma certa regi√£o, maior ser√° a plausabilidade dessas retas descreverem os dados que observamos.</p>
<p><code class="docutils literal notranslate"><span class="pre">O</span> <span class="pre">ac√∫mulo</span> <span class="pre">dessas</span> <span class="pre">retas</span> <span class="pre">representa</span> <span class="pre">a</span> <span class="pre">nossa</span> <span class="pre">incerteza.</span></code></p>
<p>√â a primeira vez que conseguimos realmente ver nossa incerteza no gr√°fico. <em>Lindo demais</em>!!!</p>
<p>Para termos uma melhor compreens√£o nesse momento, n√≥s vamos supor que ao inv√©s de nossa amostra ter 251 indiv√≠duos, vamos supor que temos apenas alguns subconjuntos. Nosso objetivo aqui √© mostrar que quanto mais informa√ß√µes temos (<em>maior a nossa amostra</em>), menor ser√° a nossa incerteza!</p>
<p>Para ficar mais claro, vamos simular a essa nossa estrat√©gia e ver a diferen√ßas dos <strong>ac√∫mulo das curvas</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_parcial_stan_models_results</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="c1"># ===============================================</span>
    <span class="c1">#   Ajustando as estimativas para N indiv√≠duos</span>
    <span class="c1"># ===============================================</span>
    
    <span class="n">weight_adjust</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 

    <span class="n">my_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height</span><span class="p">[:</span><span class="n">N</span><span class="p">],</span>
        <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_adjust</span><span class="p">[:</span><span class="n">N</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">posteriori</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">posteriori</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Recuperando os par√¢metros</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =====================================================</span>
<span class="c1">#   Plotando as linhas de incerteza do nosso modelo</span>
<span class="c1"># =====================================================</span>
<span class="c1"># A sa√≠da desse modelo pode ser muito verbosa. Os resultados ser√£o exibidos na c√©lula abaixo.</span>

<span class="n">N_10</span> <span class="o">=</span> <span class="mi">10</span>     
<span class="n">alpha_10</span><span class="p">,</span> <span class="n">beta_10</span><span class="p">,</span> <span class="n">sigma_10</span> <span class="o">=</span> <span class="n">generate_parcial_stan_models_results</span><span class="p">(</span><span class="n">N_10</span><span class="p">);</span>


<span class="n">N_50</span> <span class="o">=</span> <span class="mi">50</span>     
<span class="n">alpha_50</span><span class="p">,</span> <span class="n">beta_50</span><span class="p">,</span> <span class="n">sigma_50</span> <span class="o">=</span> <span class="n">generate_parcial_stan_models_results</span><span class="p">(</span><span class="n">N_50</span><span class="p">);</span>


<span class="n">N_100</span> <span class="o">=</span> <span class="mi">100</span>     
<span class="n">alpha_100</span><span class="p">,</span> <span class="n">beta_100</span><span class="p">,</span> <span class="n">sigma_100</span> <span class="o">=</span> <span class="n">generate_parcial_stan_models_results</span><span class="p">(</span><span class="n">N_100</span><span class="p">);</span>


<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span> <span class="c1"># Com toda amostra dispon√≠vel</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">generate_parcial_stan_models_results</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 8e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.530853, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -49.9542, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.7964, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0473698, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.204396, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0215729, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.8861, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.227055, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.267639, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.123671, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00958699, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.29753, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.233217, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0385922, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0301641, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0267526, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0240976, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.152706, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0570175, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.019068, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.213675, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0312377, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.252031, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.247947, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.19967, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64798, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.79002, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.478968, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.541932, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.655836, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.278442, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.263409, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00971906, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 8e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.242127, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.28829, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.633279, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.352361, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.153623, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0775392, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0268572, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.44439, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.600767, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.132951, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.502784, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.156488, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.225508, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.314783, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00978316, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.03784, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.625464, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0495384, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.212459, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.46016, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.700841, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.2003, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.80516, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -10.5723, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0258736, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.1e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.12344, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.19721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.8833, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.672024, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.189839, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.067269, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0430264, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.73173, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.253078, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.1845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.089491, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.13271, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -11.2199, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 7e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.330051, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.239786, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.707375, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0649797, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.224299, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.139478, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0279816, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.332621, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.171656, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.115418, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0777433, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0986705, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.49828, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0417627, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.262116, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.104363, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00215541, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.121172, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.195498, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.215866, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.517403, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0174823, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.107362, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0132078, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.95574, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0555356, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00421994, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -11.5362, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0475476, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.515512, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.554665, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.645274, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -5.3393, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.648421, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -5.89663, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.2609, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -217.279, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.5477, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.25444, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.168259, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0198966, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.109492, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.66299, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0580122, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.416087, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.98798, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -10.4333, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -9.3836, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -10.0613, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.62785, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -749.176, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -19.5107, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.72534, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0386711, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.181937, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.11519, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0734957, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.10905, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0840599, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.806341, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.239288, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0202734, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.325489, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.350651, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.49697, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.107218, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.61977, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.09356, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.539028, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.39506, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0747522, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.5154, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -151.334, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.222191, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00988014, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.111156, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.121984, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0766368, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0500666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00509562, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.155535, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.116645, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.665942, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.223857, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.254403, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.28176, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 3e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0537316, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.153607, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.354683, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.27467, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.102833, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.129812, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0614985, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00241906, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.04294, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0858322, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.087097, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.75617, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.30082, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0795467, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63639, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.56158, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.401632, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.131912, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.84061, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.775663, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -10.2474, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -13.4782, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.34843, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.581453, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.124555, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.11154, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.83101, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -5.67033, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -13.2694, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.42 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.270587, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.268754, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.10981, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0979363, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -68.0666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.199155, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0272919, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0903698, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.78753, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.239406, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.263602, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.177912, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.545378, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.49836, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.528366, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.46898, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.34107, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_bhjuoljy/model_ios4wwc7.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.1e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.7749, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.09268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -376.577, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -7.24979, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.02796, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.506776, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0595664, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0083974, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.495993, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.8072, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.3e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -12.1475, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -12.8253, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.31884, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -651.905, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -19.3477, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.162377, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.89916, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0322402, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0763243, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63297, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.95776, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.854652, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00379098, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0559983, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0383125, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.08948, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 3.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.32 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -91.3706, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -3.03354, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.138891, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.501545, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.5301, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.730819, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.47657, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0431793, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.52907, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -2.13715, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.84797, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0373841, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -6.19972, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.392525, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.570856, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.00742766, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.298791, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.109211, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -4.48887, but must be nonnegative! (in &#39;/tmp/httpstan_lko543u1/model_ios4wwc7.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
</div>
</div>
<p>Uma das vantagens do gr√°fico gr√°fico de linhas (<code class="docutils literal notranslate"><span class="pre">gr√°fico</span> <span class="pre">de</span> <span class="pre">espaguetes</span></code>) √© deixar claro que os limites  formados pelas retas n√£o tem um significado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =============================</span>
<span class="c1">#     Gr√°fico de Espaguete</span>
<span class="c1"># =============================</span>

<span class="c1"># Vamos estimar na c√©lula de cima apenas para n√£o poluir a saƒ©da com o gr√°fico</span>
<span class="c1"># Vamos usar o weight_adjust igual para todos os pesos sem perda de generalidade</span>

<span class="c1"># Plot dos dados altura x peso</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">],</span> <span class="p">[</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>

<span class="c1"># N√∫mero de linhas retas que iremos plotar</span>
<span class="n">qty_lines</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 10 amostras</span>
<span class="c1"># ===============================================</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_10</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_10</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qty_lines</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">alpha_10</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta_10</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">weight_adjust</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estimativa com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos amostrados&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (Weight)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (Height)&#39;</span><span class="p">)</span>


<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 50 amostras</span>
<span class="c1"># ===============================================</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_50</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_50</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qty_lines</span><span class="p">):</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">alpha_50</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta_50</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">weight_adjust</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estimativa com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_50</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos amostrados&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (Weight)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (Height)&#39;</span><span class="p">)</span>


<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 100 amostras</span>
<span class="c1"># ===============================================</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_100</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_100</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qty_lines</span><span class="p">):</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">alpha_100</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta_100</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">weight_adjust</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estimativa com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_100</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos amostrados&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (Weight)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (Height)&#39;</span><span class="p">)</span>


<span class="c1"># =================================================</span>
<span class="c1">#    Estimando as curvas usando todas as amostras</span>
<span class="c1"># =================================================</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">qty_lines</span><span class="p">):</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">weight_adjust</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estimativa com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; (todos) pontos amostrados&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (Weight)&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (Height)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_17_0.png" src="_images/Aula_2__week_4_17_0.png" />
</div>
</div>
<p>Essa divis√£o foi constru√≠da para conseguirmos percerber, de modo visual, que quando mais amostras tivermos coletado (isto √©, um <em>quanto maior n√∫mero de pontos azuis tivermos</em>), mais informa√ß√µes teremos e, portanto, teremos muito menos incerteza sobre o nosso objeto de estudo.</p>
<p>A nossa incerteza pode ser observada pela dispers√£o das curvas no gr√°fico, portanto quanto maior for a dispers√£o maior ser√° a nossa incerteza sobre o que est√° acontecendo.</p>
</div>
<div class="section" id="construindo-a-distribuicao-preditiva-de-mu-i-dado-um-peso-especifico-x-i">
<h2>Construindo a Distribui√ß√£o Preditiva de $\mu_i$ dado um peso espec√≠fico  $x_i$<a class="headerlink" href="#construindo-a-distribuicao-preditiva-de-mu-i-dado-um-peso-especifico-x-i" title="Permalink to this headline">¬∂</a></h2>
<p>Modelo linear para a altura m√©dia:</p>
<p>$$ \mu_i = \alpha + \beta(x_i - \bar{x}) $$</p>
<p>Agora a ideia b√°sica √© que para um valor espec√≠fico do peso $x_i$ (<em>weight</em>) existe uma distribui√ß√£o preditiva de $\mu_i$. Essa densidade preditiva nos informa quais as regi√µes de maior confian√ßa que podemos esperar para a m√©dia da altura de uma pessoa com esse peso espec√≠fico.</p>
<p>Para exemplificar, vamos supor que queremos estimar a altura (<em>height</em>) de uma pessoa com $50 kg$.</p>
<p>$$ \mu_i = \alpha + \beta(50 - \bar{x}) $$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===========================================================</span>
<span class="c1">#   Construindo a distribui√ß√£o preditiva de mu | weight=50</span>
<span class="c1"># ===========================================================</span>

<span class="n">mu_50_kg</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mu_50_kg</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribui√ß√£o de $\mu_i$ para o peso de $50 kg$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Plausabilidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\mu | peso=50$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_20_0.png" src="_images/Aula_2__week_4_20_0.png" />
</div>
</div>
<div class="section" id="calculando-a-predicao-para-todos-os-mu">
<h3>Calculando a predi√ß√£o para todos os $\mu$<a class="headerlink" href="#calculando-a-predicao-para-todos-os-mu" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">HPDI</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">,</span> <span class="n">credible_mass</span><span class="p">):</span>
    
    <span class="c1"># Calcula o maior intervalo de probabilidades a partir de uma amostra</span>
    
    <span class="c1"># Fonte: https://stackoverflow.com/questions/22284502/highest-posterior-density-region-and-central-credible-region</span>
    <span class="c1"># ** Refazer essa fun√ß√£o para entender **</span>
    
    <span class="n">sorted_points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">)</span>
    <span class="n">ciIdxInc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">credible_mass</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_points</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
    <span class="n">nCIs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_points</span><span class="p">)</span> <span class="o">-</span> <span class="n">ciIdxInc</span>
    <span class="n">ciWidth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">nCIs</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nCIs</span><span class="p">):</span>
        <span class="n">ciWidth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted_points</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ciIdxInc</span><span class="p">]</span> <span class="o">-</span> <span class="n">sorted_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">HDImin</span> <span class="o">=</span> <span class="n">sorted_points</span><span class="p">[</span><span class="n">ciWidth</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ciWidth</span><span class="p">))]</span>
        <span class="n">HDImax</span> <span class="o">=</span> <span class="n">sorted_points</span><span class="p">[</span><span class="n">ciWidth</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ciWidth</span><span class="p">))</span><span class="o">+</span><span class="n">ciIdxInc</span><span class="p">]</span>

    <span class="k">return</span><span class="p">(</span><span class="n">HDImin</span><span class="p">,</span> <span class="n">HDImax</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =====================================</span>
<span class="c1">#    Calculando o HPDI dos dados</span>
<span class="c1"># =====================================</span>

<span class="n">posterioris_dict_10</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dicion√°rio com todas as posterioris para cada um dos pesos (weight) variando de 25 √° 70.</span>
<span class="n">posterioris_dict_50</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dicion√°rio com todas as posterioris para cada um dos pesos (weight) variando de 25 √° 70.</span>
<span class="n">posterioris_dict_100</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dicion√°rio com todas as posterioris para cada um dos pesos (weight) variando de 25 √° 70.</span>
<span class="n">posterioris_dict</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dicion√°rio com todas as posterioris para cada um dos pesos (weight) variando de 25 √° 70.</span>

<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">):</span>
    <span class="n">posterioris_dict_10</span><span class="p">[</span><span class="n">weight_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_10</span> <span class="o">+</span> <span class="n">beta_10</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_i</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">posterioris_dict_50</span><span class="p">[</span><span class="n">weight_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_50</span> <span class="o">+</span> <span class="n">beta_50</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_i</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">posterioris_dict_100</span><span class="p">[</span><span class="n">weight_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_100</span> <span class="o">+</span> <span class="n">beta_100</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_i</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">posterioris_dict</span><span class="p">[</span><span class="n">weight_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_i</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    
<span class="n">posterioris_10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">posterioris_dict_10</span><span class="p">)</span>
<span class="n">posterioris_50</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">posterioris_dict_50</span><span class="p">)</span>
<span class="n">posterioris_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">posterioris_dict_100</span><span class="p">)</span>
<span class="n">posterioris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">posterioris_dict</span><span class="p">)</span>

<span class="n">posterioris_means_10</span> <span class="o">=</span> <span class="n">posterioris_10</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">posterioris_means_50</span> <span class="o">=</span> <span class="n">posterioris_50</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">posterioris_means_100</span> <span class="o">=</span> <span class="n">posterioris_100</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">posterioris_means</span> <span class="o">=</span> <span class="n">posterioris</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">posterioris_HPDIs_10</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posterioris_HPDIs_50</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posterioris_HPDIs_100</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posterioris_HPDIs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">):</span>
    <span class="n">posterioris_HPDIs_10</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posterioris_10</span><span class="p">[</span><span class="n">weight_i</span><span class="p">],</span> <span class="mf">0.89</span><span class="p">))</span>
    <span class="n">posterioris_HPDIs_50</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posterioris_50</span><span class="p">[</span><span class="n">weight_i</span><span class="p">],</span> <span class="mf">0.89</span><span class="p">))</span>
    <span class="n">posterioris_HPDIs_100</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posterioris_100</span><span class="p">[</span><span class="n">weight_i</span><span class="p">],</span> <span class="mf">0.89</span><span class="p">))</span>
    <span class="n">posterioris_HPDIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posterioris</span><span class="p">[</span><span class="n">weight_i</span><span class="p">],</span> <span class="mf">0.89</span><span class="p">))</span>
    
<span class="n">posterioris_HPDIs_10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posterioris_HPDIs_10</span><span class="p">)</span>  <span class="c1"># Apenas a transforma√ß√£o em um array numpy</span>
<span class="n">posterioris_HPDIs_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posterioris_HPDIs_50</span><span class="p">)</span>  <span class="c1"># Apenas a transforma√ß√£o em um array numpy</span>
<span class="n">posterioris_HPDIs_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posterioris_HPDIs_100</span><span class="p">)</span>  <span class="c1"># Apenas a transforma√ß√£o em um array numpy</span>
<span class="n">posterioris_HPDIs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posterioris_HPDIs</span><span class="p">)</span>  <span class="c1"># Apenas a transforma√ß√£o em um array numpy</span>
</pre></div>
</div>
</div>
</div>
<p>Agora, assim como nos gr√°ficos anteriores acima, iremos replotar os mesmos 4 gr√°ficos, mas agora usando o gr√°fico mostrando o intervalo de compatilidade (<code class="docutils literal notranslate"><span class="pre">estilo</span> <span class="pre">gravata</span> <span class="pre">borboleta</span></code>).</p>
<a class="reference internal image-reference" href="_images/bow_tie.jpg"><img alt="Bow Tie" src="_images/bow_tie.jpg" style="width: 400px;" /></a>
<p>Ao olhar para esse gr√°fico √© f√°cil carimos na tenta√ß√£o de acharmos que os limites que escolhemos significa alguma coisa, ele n√£o tem nenhum significado a n√£o ser os limites de corte pelo HPDI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==================================================</span>
<span class="c1">#       Plotando os gr√°fico de gravata borboletas</span>
<span class="c1"># ==================================================</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">[[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">],</span> <span class="p">[</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 10 amostras</span>
<span class="c1"># ===============================================</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_10</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_HPDIs_10</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_10</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_10</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_means_10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da m√©dia altura com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos de amostras&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 50 amostras</span>
<span class="c1"># ===============================================</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_50</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_HPDIs_50</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_50</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_50</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_means_50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da m√©dia alturacom N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_50</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos de amostras&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="c1"># ===============================================</span>
<span class="c1">#    Estimando as curvas usando 100 amostras</span>
<span class="c1"># ===============================================</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs_100</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_HPDIs_100</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">[:</span><span class="n">N_100</span><span class="p">],</span> <span class="n">height</span><span class="p">[:</span><span class="n">N_100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_means_100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da m√©dia altura com N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N_100</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pontos de amostras&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="c1"># ==================================================</span>
<span class="c1">#    Estimando as curvas usando todas as amostras</span>
<span class="c1"># ==================================================</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_HPDIs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_means</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da m√©dia altura com todos os pontos de amostras&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_25_0.png" src="_images/Aula_2__week_4_25_0.png" />
</div>
</div>
<p>Perceba que nos gr√°ficos de borboletas n√≥s usamos os cortes para os intervalos com $89%$. Isso √© apenas para mostrar que n√£o, isso mesmo, n√£o existe nada especial nos cortes do HPDI. Mas os cortes mais usuais de $50%$, $80%$ ou $95%$, corriqueiramente usados em outras escolas estat√≠sticas, s√£o apenas cortes que queremos visualizar. Nada mais!</p>
<p>At√© agora n√≥s fizemos os gr√°ficos apenas usando os par√¢metros da m√©dia, mas podemos construir o gr√°fico de envelope para o sigma tamb√©m. Iremos construir ambos utilizando toda a nossa amostra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ============================================================================</span>
<span class="c1">#     Plotando o HPDI da distribui√ß√£o preditiva da alutra e de sua m√©dia</span>
<span class="c1"># ============================================================================</span>
<span class="n">posterioris_height_HPDIs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">HPDI_range</span> <span class="o">=</span> <span class="mf">0.93</span>  <span class="c1"># Define o tamanho do intervalo do HPDI. Altere o valor para ver a diferen√ßa.</span>

<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">):</span>
    <span class="n">posteiori_height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">weight_i</span> <span class="o">-</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">posterioris_height_HPDIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posteiori_height</span><span class="p">,</span> <span class="n">HPDI_range</span><span class="p">))</span>
    
<span class="n">posterioris_height_HPDIs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posterioris_height_HPDIs</span><span class="p">)</span>

<span class="c1"># Plontando o gr√°fico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_height_HPDIs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_height_HPDIs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_height_HPDIs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_HPDIs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posterioris_HPDIs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span> <span class="n">posterioris_means</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da altura - Usando  HPDI  com &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">HPDI_range</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">e massa de probabilidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_28_0.png" src="_images/Aula_2__week_4_28_0.png" />
</div>
</div>
<p>Como podemos ver no gr√°fico acima, temos duas regi√µes de confian√ßa. A regi√£o mais interna, azul escura, nos indica que esse trecho cont√©m $89%$ de probabilidade da m√©dia estar ali dentro, para cada um dos pesos medidos.
J√° a regi√£o mais externa, aquele azul mais clara, nos indica que, com $93%$ probabilidade, ser√° a regi√£o mais prov√°vel para altura da pessoa que tenha um peso espef√≠cico.</p>
<p>Como teste para conseguir compreender melhor, fa√ßa o teste a altera a vari√°vel <code class="docutils literal notranslate"><span class="pre">HPDI_range</span></code> para valores bem altos, como por exemplo, $0.99$ e veja o quanto a faixa mais externa  cobre os dados. Para valores menores, isso tamb√©m ocorre, como por exemplo, $0.7$.</p>
<p>Obs: A utiliza√ß√£o de valores muito baixos, demanda c√°lculos mais complexos e poor isso pode ser demorada.</p>
</div>
</div>
<div class="section" id="curvas-a-partir-das-linhas-retas">
<h2>Curvas a partir das Linhas Retas<a class="headerlink" href="#curvas-a-partir-das-linhas-retas" title="Permalink to this headline">¬∂</a></h2>
<p>O interessante de modelos lineares √© que eles n√£o s√£o apenas lineares, podem ser curvas tamb√©m. Isso √© uma coisa meio enloquecedora sobre o termo que √© convencionalmente  usado para desenhar linhas retas em gr√°ficos.</p>
<p>Mas uma regress√£o linear √© aditiva, voc√™ vai ter essa equa√ß√£o para m√©dia que √© a soma de alguns par√¢metros vezes algumas vari√°vel observada. Com a soma de um monte de termos como esse. √â uma equa√ß√£o aditiva e coisas aditivas s√£o lineares na matem√°tica.</p>
<p>Mas para n√≥s as palavras ‚Äúadtivo‚Äù e linear s√£o diferentes, ent√£o chamaremos esses modelos de <code class="docutils literal notranslate"><span class="pre">Regress√µes</span> <span class="pre">Aditivas</span></code>. Por que podemos usar coisas que n√£o parecem linhas retas. E de agora at√© o final do cap√≠tulo iremos fazer isso,  <em>desenhar curvas a partir de linhas retas</em>.</p>
<p>Mas antes de fazer, por que √© interessante aprendermos a fazer esse tipo de modelagem? Simples, por que a Natureza n√£o se limita a se manifestar por rela√ß√µes lineares entre  duas vari√°veis! Os nossos ranges podem ser aproxima√ß√µes √∫teis, mas geralmente s√£o bobos.</p>
<p>No nosso caso, n√≥s usamos as vari√°veis <em>altura</em> e <em>peso</em>, por√©m apenas para indiv√≠duos que tivessem $30$ anos ou mais. Se foss√™mos usar todos os indiv√≠duos a rela√ß√£o de peso e altura n√£o mais seria uma linha reta, mas sim uma curva.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">height_0_18</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">weight_0_18</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">height_18_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">weight_18_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_0_18</span><span class="p">,</span> <span class="n">height_0_18</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;De 0 a 17 anos de idade&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_18_</span><span class="p">,</span> <span class="n">height_18_</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(Adultos) 18+ anos de idade&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Altura x peso | Todos os indiv√≠duos da amostra&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_32_0.png" src="_images/Aula_2__week_4_32_0.png" />
</div>
</div>
<p>Vamos ver dois modos de construir os modelos de <code class="docutils literal notranslate"><span class="pre">Regress√£o</span> <span class="pre">Aditivos</span></code>:</p>
<ul class="simple">
<li><p><strong>Regress√£o Polinomial</strong></p>
<ul>
<li><p>Usada de forma comum</p></li>
<li><p>Geralmente aprensenta um comportamento bem ruim</p></li>
</ul>
</li>
</ul>
<p>Esse √© um tipo bem comum de regress√£o, mas tamb√©m √© um modelo bem ruim. N√£o h√° nada de errado usar esse tipo de regress√£o supondo que voc√™ entenda o que golem est√° fazendo e assim usar de forma respons√°vel. Geralmente se utilizam sem uma devida aten√ß√£o. Iremos ver o motivo dele serem mal comportados.</p>
<ul class="simple">
<li><p><strong>Splines</strong></p>
<ul>
<li><p>S√£o muito flex√≠veis</p></li>
<li><p>Altamente Geoc√™ntrica</p></li>
</ul>
</li>
</ul>
<p>Existem muitos tipos de splines, mas n√≥s iremos ver aqui as splines de base, que s√£o provav√©lmente as mais comuns. Software de desenhos como <code class="docutils literal notranslate"><span class="pre">GIMP</span></code>, <code class="docutils literal notranslate"><span class="pre">Blender</span></code> e etc. que possuem a ferramenta <em>curvas de Bezier</em>, nada mais s√£o do que splines de base.</p>
<p>As Splines s√£o muito flex√≠veis, muito mais flex√≠veis do que as Regress√µes Polinomiais, por√©m n√£o apresentam a patologia que os polin√¥mios apresentam, e por isso s√£o considerado na maioria dos casos melhores que as regress√µes polin√¥miais.</p>
<p>Por√©m tanto as splines quantos as regress√µes polinomiais s√£o <code class="docutils literal notranslate"><span class="pre">estrat√©gias</span> <span class="pre">geoc√™ntrica</span></code>, n√£o h√° nada de cient√≠fico nelas, s√£o apenas aproxima√ß√µes com epiciclos de Ptolomeu.</p>
<p>Extrapola√ß√µes com esses modelos podem trazer desastres nas predi√ß√µes, por isso √© necess√°rio checar e entender o que est√° acontecendo com o modelo.</p>
</div>
<div class="section" id="regressao-polinomial">
<h2>Regress√£o Polinomial<a class="headerlink" href="#regressao-polinomial" title="Permalink to this headline">¬∂</a></h2>
<p>Estrat√©gia puramente descritiva (<em>geoc√™ntrico</em>) usando uma vari√°vel com preditor polinomial.</p>
<ul class="simple">
<li><p>1a Ordem (Linha): $ \mu_i = \alpha + \beta_1x_i $</p></li>
<li><p>2a Ordem (Par√°bola):  $\mu_i = \alpha + \beta_1x_i + \beta_2x^2_i$</p></li>
</ul>
<div class="section" id="modelo-parabolico-da-altura">
<h3>Modelo Parab√≥lico da Altura<a class="headerlink" href="#modelo-parabolico-da-altura" title="Permalink to this headline">¬∂</a></h3>
<p>O modelo parab√≥lico pode ser definido da seguinte forma:</p>
<p>$$ h_i \sim Normal(\mu_i, \sigma) $$</p>
<p>$$ \mu_i =  \alpha + \beta_1x_i + \beta_2x^2_i $$</p>
<p>$$ \alpha \sim Normal(178, 20) $$</p>
<p>$$ \beta_1 \sim  Log-Normal(0, 1) $$</p>
<p>$$ \beta_2  \sim  Normal(0,  1) $$</p>
<p>$$ \sigma \sim Uniform(0,  50) $$</p>
<p>O problema desse modelo √© que os termo $\beta_1$ e $\beta_2$ n√£o tem um significado biol√≥gico, √© apenas um ajuste na curvatura da fun√ß√£o. Por esse motivo n√≥s temos que simular para entender oque est√° acontecendo com a priori. Se n√£o entendermos o que s√£o essas vari√°veis, as nossa posterioris n√£o teram sentido interpretativo.</p>
<p>N√£o √© para n√£o usar, mas usar com responsabilidade.</p>
</div>
<div class="section" id="padronizar-os-preditores">
<h3>Padronizar os Preditores<a class="headerlink" href="#padronizar-os-preditores" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>√â muito √∫til padronizar as vari√°veis preditoras antes de ajustar o modelo.</p>
<ul>
<li><p>Torna a estima√ß√£o mais simples</p></li>
<li><p>Aux√≠lia na interpreta√ß√£o (<em>alguma vezes</em>)</p></li>
</ul>
</li>
</ul>
<p>Para padronizar siga os seguinte passos para todos os dados:</p>
<ul class="simple">
<li><p>subtrair da m√©dia.</p></li>
<li><p>dividir pelo desvio padr√£o.</p></li>
<li><p>Resultando: M√©dia = 0 e Desvio Padr√£o = 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =================================================================</span>
<span class="c1">#       Construindo o Modelo de Regress√£o Parab√≥lica | Parcial</span>
<span class="c1"># =================================================================</span>

<span class="n">weight_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># X_i</span>
<span class="n">height_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Y_i</span>

<span class="c1"># Ajustando o modelo para pessoas acimas dos 18 anos - Teste de ajuste</span>
<span class="n">height_full_30</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">weight_full_30</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">weight_full_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>
<span class="n">weight_full_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>

<span class="n">weight_full_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">weight_full_30</span> <span class="o">-</span> <span class="n">weight_full_mean</span><span class="p">)</span><span class="o">/</span><span class="n">weight_full_std</span>   <span class="c1"># Padronizando as vari√°veis explicativa</span>

<span class="n">model_stan_regression_parabolic</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">data {</span>
<span class="s2">    int N;</span>
<span class="s2">    vector[N] weight;</span>
<span class="s2">    vector[N] weight_2;</span>
<span class="s2">    vector[N] height;</span>
<span class="s2">}</span>

<span class="s2">parameters {</span>
<span class="s2">    real alpha;</span>
<span class="s2">    real&lt;lower=0&gt; beta_1;</span>
<span class="s2">    real beta_2;</span>
<span class="s2">    real&lt;lower=0, upper=50&gt; sigma;  // Priori Uniform (0, 50)</span>
<span class="s2">}</span>

<span class="s2">model {</span>
<span class="s2">    alpha ~ normal(178, 20);</span>
<span class="s2">    beta_1 ~ lognormal(0, 1);</span>
<span class="s2">    beta_2 ~ normal(0, 1);</span>
<span class="s2">    </span>
<span class="s2">    height ~ normal(alpha + beta_1*weight + beta_2*weight_2, sigma);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">my_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">),</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="p">,</span>
    <span class="s1">&#39;weight_2&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height_full_30</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan_regression_parabolic</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">posteriori</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># rp := refer√™nte ao modelo de Regress√£o Parab√≥lica</span>
<span class="n">alpha_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_1_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_2_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_spzyfke5/model_r3rpmsmg.stan&#39;, line 17, column 24: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_spzyfke5/model_r3rpmsmg.stan&#39;, line 17, column 19: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 5e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 5e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 1.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 6e-06 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===================================================</span>
<span class="c1">#   Probabilidade √† Posteriori de mu</span>
<span class="c1"># ===================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">mu_poli</span> <span class="o">=</span> <span class="n">alpha_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta_1_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="o">+</span> <span class="n">beta_2_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">mu_poli</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Pontos da amostra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full_30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajuste do modelo de Regress√£o Polinonimal com N=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight_full</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; pontos da amostra.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_40_0.png" src="_images/Aula_2__week_4_40_0.png" />
</div>
</div>
<p>Regress√µes Polinomiais tem esse tipo de anomalia impl√≠cita, dentro dentro da regi√£o dos pontos ela se comporta de modo aceit√°vel, por√©m fora da regi√£o dos pontos, a fun√ß√£o se torna descontrolada. Isso ocorre porque exitem muitas outras func√µes de segundo grau que podem ser ajustadas nesse conjunto de pontos. Isso n√£o ocorre com tanta intensidade nas regress√µes com splines.</p>
<p>Perceba que para a esquerda do <em>zero</em> no eixo do peso (peso est√° normalizado) a func√£o come√ßa perder o controle e atinge valores que podem ser verdadeiros.</p>
<p>Uma segundo incoveniente que ocorre com Regress√µes Polinomiais √© sua pr√≥pria estrutura matem√°tica. Apenas tr√™s par√¢metros, o $\alpha$, o $\beta_1$ e o $\beta_2$, controlam todo o comportamento da curva. Isso a torna um pouco mais r√≠gida para situa√ß√µes que precisamos de mais flexibilildade. As splines padr√µes tem a sua constru√ß√£o baseada em uma estrutura que evita esse tipo de inconveniente.</p>
<p>Lembre-se, ambos modelos, tanto os polinomiais quanto modelos com splines, s√£o modelos <em>geocentricos</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Par√¢mentros</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">alpha_rp</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori Alpha&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">beta_1_rp</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori $Beta_1$&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">beta_2_rp</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Posteriori $Beta_2$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_42_0.png" src="_images/Aula_2__week_4_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==================================================================================</span>
<span class="c1">#       Construindo o Modelo de Regress√£o Parab√≥lica | Usando a Amostra Completa</span>
<span class="c1"># ==================================================================================</span>

<span class="n">weight_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># X_i</span>
<span class="n">height_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Y_i</span>

<span class="n">weight_full_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>
<span class="n">weight_full_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>

<span class="n">weight_full_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">weight_full</span> <span class="o">-</span> <span class="n">weight_full_mean</span><span class="p">)</span><span class="o">/</span><span class="n">weight_full_std</span>   <span class="c1"># Padronizando as vari√°veis explicativa</span>

<span class="n">model_stan_regression_parabolic</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data {</span>
<span class="s2">        int N;</span>
<span class="s2">        vector[N] weight;</span>
<span class="s2">        vector[N] weight_2;</span>
<span class="s2">        vector[N] height;</span>
<span class="s2">    }</span>

<span class="s2">    parameters {</span>
<span class="s2">        real alpha;</span>
<span class="s2">        real&lt;lower=0&gt; beta_1;</span>
<span class="s2">        real beta_2;</span>
<span class="s2">        real&lt;lower=0, upper=50&gt; sigma;  // Priori Uniform (0, 50)</span>
<span class="s2">    }</span>

<span class="s2">    model {</span>
<span class="s2">        alpha ~ normal(178, 20);</span>
<span class="s2">        beta_1 ~ lognormal(0, 1);</span>
<span class="s2">        beta_2 ~ normal(0, 1);</span>

<span class="s2">        height ~ normal(alpha + beta_1*weight + beta_2*weight_2, sigma);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">my_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">),</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="p">,</span>
    <span class="s1">&#39;weight_2&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height_full</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan_regression_parabolic</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">posteriori</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># rp := refer√™nte ao modelo de Regress√£o Parab√≥lica</span>
<span class="n">alpha_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_1_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_2_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_rp</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_gsgxp_0b/model_s74v7a2l.stan&#39;, line 17, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_gsgxp_0b/model_s74v7a2l.stan&#39;, line 17, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  10% (800/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  35% (2800/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  60% (4800/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  85% (6800/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 6.3e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.63 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 7.6e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.76 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 0.000103 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 1.03 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: normal_lpdf: Location parameter[1] is inf, but must be finite! (in &#39;/tmp/httpstan_inux9ifx/model_s74v7a2l.stan&#39;, line 21, column 8 to column 72)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 7.5e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.75 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===================================================</span>
<span class="c1">#   Probabilidade √† Posteriori de mu</span>
<span class="c1"># ===================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">mu_poli</span> <span class="o">=</span> <span class="n">alpha_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta_1_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="o">+</span> <span class="n">beta_2_rp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">mu_poli</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Pontos da amostra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajuste do modelo de Regress√£o Polinonimal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_44_0.png" src="_images/Aula_2__week_4_44_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ============================================</span>
<span class="c1">#      Probabilidade √† Posteriori - HPDI</span>
<span class="c1"># ============================================</span>
<span class="n">posteriori_polinomial2_HPDI</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posteriori_polinomial2_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posteriori_polinomial2_sigma</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
    <span class="n">mu_poli</span> <span class="o">=</span> <span class="n">alpha_rp</span> <span class="o">+</span> <span class="n">beta_1_rp</span> <span class="o">*</span> <span class="n">weight_i</span> <span class="o">+</span> <span class="n">beta_2_rp</span> <span class="o">*</span> <span class="n">weight_i</span><span class="o">**</span><span class="mi">2</span>  
    <span class="n">posteriori_polinomial2_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mu_poli</span><span class="p">))</span>  <span class="c1"># m√©dia</span>
    <span class="n">posteriori_polinomial2_HPDI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">mu_poli</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">))</span>  <span class="c1"># HPDI</span>
    <span class="n">posteriori_polinomial2_sigma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu_poli</span><span class="p">,</span> <span class="n">sigma_rp</span><span class="p">),</span> <span class="mf">0.89</span><span class="p">))</span>
    
<span class="n">posteriori_polinomial2_HPDI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posteriori_polinomial2_HPDI</span><span class="p">)</span>
<span class="n">posteriori_polinomial2_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posteriori_polinomial2_sigma</span><span class="p">)</span>

<span class="c1"># Plontando o gr√°fico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_sigma</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial2_sigma</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da altura - Usando  HPDI  com &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">HPDI_range</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">e massa de probabilidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_45_0.png" src="_images/Aula_2__week_4_45_0.png" />
</div>
</div>
</div>
<div class="section" id="modelos-cubicos">
<h3>Modelos C√∫bicos<a class="headerlink" href="#modelos-cubicos" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================================</span>
<span class="c1">#       Construindo o Modelo de Regress√£o Parab√≥lica de 3 Grau | Usando a Amostra Completa</span>
<span class="c1"># ==============================================================================================</span>

<span class="n">weight_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># X_i</span>
<span class="n">height_full</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Y_i</span>

<span class="n">weight_full_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>
<span class="n">weight_full_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weight_full</span><span class="p">)</span>

<span class="n">weight_full_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">weight_full</span> <span class="o">-</span> <span class="n">weight_full_mean</span><span class="p">)</span><span class="o">/</span><span class="n">weight_full_std</span>   <span class="c1"># Padronizando as vari√°veis explicativa</span>



<span class="n">model_stan_regression_parabolic_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">data {</span>
<span class="s2">    int N;</span>
<span class="s2">    vector[N] weight;</span>
<span class="s2">    vector[N] weight_2;</span>
<span class="s2">    vector[N] weight_3;</span>
<span class="s2">    vector[N] height;</span>
<span class="s2">}</span>

<span class="s2">parameters {</span>
<span class="s2">    real alpha;</span>
<span class="s2">    real beta_1;</span>
<span class="s2">    real beta_2;</span>
<span class="s2">    real beta_3;</span>
<span class="s2">    real&lt;lower=0, upper=50&gt; sigma;  // Priori Uniform (0, 50)</span>
<span class="s2">}</span>

<span class="s2">model {</span>
<span class="s2">    alpha ~ normal(178, 20);</span>
<span class="s2">    beta_1 ~ lognormal(0, 1);</span>
<span class="s2">    beta_2 ~ normal(0, 1);</span>
<span class="s2">    beta_3 ~ normal(0, 1);</span>
<span class="s2">    </span>
<span class="s2">    height ~ normal(alpha + beta_1*weight + beta_2*weight_2 + beta_3*weight_3, sigma);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">my_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">),</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="p">,</span>
    <span class="s1">&#39;weight_2&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;weight_3&#39;</span><span class="p">:</span> <span class="n">weight_full_std</span> <span class="o">**</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height_full</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">posteriori_p3</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan_regression_parabolic_3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>

<span class="n">fit_p3</span> <span class="o">=</span> <span class="n">posteriori_p3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># rp := refer√™nte ao modelo de Regress√£o Parab√≥lica</span>
<span class="n">alpha_rp3</span> <span class="o">=</span> <span class="n">fit_p3</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_1_rp3</span> <span class="o">=</span> <span class="n">fit_p3</span><span class="p">[</span><span class="s1">&#39;beta_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_2_rp3</span> <span class="o">=</span> <span class="n">fit_p3</span><span class="p">[</span><span class="s1">&#39;beta_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_3_rp3</span> <span class="o">=</span> <span class="n">fit_p3</span><span class="p">[</span><span class="s1">&#39;beta_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_rp3</span> <span class="o">=</span> <span class="n">fit_p3</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_zjfpq_nn/model_5iz6652s.stan&#39;, line 20, column 4: Parameter beta_1 is given a lognormal distribution, which has strictly positive support, but beta_1 was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_zjfpq_nn/model_5iz6652s.stan&#39;, line 19, column 24: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_zjfpq_nn/model_5iz6652s.stan&#39;, line 19, column 19: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   2% (200/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   8% (600/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  12% (1000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  18% (1400/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  40% (3200/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  60% (4800/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  80% (6400/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 0.000119 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 1.19 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.112797, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.23841, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 9.3e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.93 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 0.00014 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 1.4 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.78286, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63254, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.0216599, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.400735, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.889696, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.275904, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.35424, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.74341, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.59443, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.755455, but must be nonnegative! (in &#39;/tmp/httpstan_j15e_hoc/model_5iz6652s.stan&#39;, line 20, column 4 to column 29)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 0.0001 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 1 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===================================================</span>
<span class="c1">#   Probabilidade √† Posteriori de mu</span>
<span class="c1"># ===================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">mu_poli3</span> <span class="o">=</span> <span class="n">alpha_rp3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> \
              <span class="n">beta_1_rp3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
              <span class="n">beta_2_rp3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
              <span class="n">beta_3_rp3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">mu_poli3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Pontos da amostra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajuste do modelo de Regress√£o Polinonimal 3 Grau&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_48_0.png" src="_images/Aula_2__week_4_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ============================================</span>
<span class="c1">#      Probabilidade √† Posteriori - HPDI </span>
<span class="c1"># ============================================</span>
<span class="n">posteriori_polinomial3_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posteriori_polinomial3_HPDI</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posteriori_polinomial3_sigma</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
    <span class="n">mu_poli3</span> <span class="o">=</span> <span class="n">alpha_rp3</span> <span class="o">+</span> <span class="n">beta_1_rp3</span> <span class="o">*</span> <span class="n">weight_i</span> <span class="o">+</span> <span class="n">beta_2_rp3</span> <span class="o">*</span> <span class="n">weight_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">beta_3_rp3</span> <span class="o">*</span> <span class="n">weight_i</span><span class="o">**</span><span class="mi">3</span> 
    <span class="n">posteriori_polinomial3_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mu_poli3</span><span class="p">))</span>  <span class="c1"># m√©dia</span>
    <span class="n">posteriori_polinomial3_HPDI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">mu_poli3</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">))</span>  <span class="c1"># HPDI</span>
    <span class="n">posteriori_polinomial3_sigma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu_poli3</span><span class="p">,</span> <span class="n">sigma_rp3</span><span class="p">),</span> <span class="mf">0.89</span><span class="p">))</span>
    
<span class="n">posteriori_polinomial3_HPDI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posteriori_polinomial3_HPDI</span><span class="p">)</span>
<span class="n">posteriori_polinomial3_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posteriori_polinomial3_sigma</span><span class="p">)</span>

<span class="c1"># Plontando o gr√°fico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_sigma</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial3_sigma</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intervalos HPDI da posteriori da altura - Usando  HPDI  com &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">HPDI_range</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">e massa de probabilidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_49_0.png" src="_images/Aula_2__week_4_49_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================</span>
<span class="c1">#     Construindo o modelo de 1 grau para a compara√ß√£o | Regress√£o Linear</span>
<span class="c1"># ==============================================================================</span>

<span class="n">height_p1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span>
<span class="n">weight_p1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">values</span>

<span class="n">weight_p1_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">weight_p1</span> <span class="o">-</span> <span class="n">weight_p1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weight_p1</span><span class="p">)</span>

<span class="n">model_stan_polinomio_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data {</span>
<span class="s2">        int N;</span>
<span class="s2">        vector[N] weight;</span>
<span class="s2">        vector[N] height;</span>
<span class="s2">    }</span>

<span class="s2">    parameters {</span>
<span class="s2">        real alpha;</span>
<span class="s2">        real beta;</span>
<span class="s2">        real&lt;lower=0, upper=50&gt; sigma;</span>
<span class="s2">    }</span>

<span class="s2">    model {</span>
<span class="s2">        alpha ~ normal(178, 20);</span>
<span class="s2">        beta ~ lognormal(0, 1);</span>
<span class="s2">        </span>
<span class="s2">        height ~ normal(alpha + beta*weight, sigma);</span>
<span class="s2">    }</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">height_p1</span><span class="p">),</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">weight_p1_s</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height_p1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">posteriori_p1</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_stan_polinomio_1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">fit_p1</span> <span class="o">=</span> <span class="n">posteriori_p1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">alpha_p1</span> <span class="o">=</span> <span class="n">fit_p1</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">beta_p1</span> <span class="o">=</span> <span class="n">fit_p1</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_p1</span> <span class="o">=</span> <span class="n">fit_p1</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning in &#39;/tmp/httpstan_wc8togpo/model_pmoxy2ci.stan&#39;, line 16, column 8: Parameter beta is given a lognormal distribution, which has strictly positive support, but beta was not constrained to be strictly positive.
Warning in &#39;/tmp/httpstan_wc8togpo/model_pmoxy2ci.stan&#39;, line 15, column 28: Argument 20 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/tmp/httpstan_wc8togpo/model_pmoxy2ci.stan&#39;, line 15, column 23: Argument 178 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning: Your Stan program has a parameter sigma with a lower and upper bound in its declaration. These hard constraints are not recommended, for two reasons: (a) Except when there are logical or physical constraints, it is very unusual for you to be sure that a parameter will fall inside a specified range, and (b) The infinite gradient induced by a hard constraint can cause difficulties for Stan&#39;s sampling algorithm. As a consequence, we recommend soft constraints rather than hard constraints; for example, instead of constraining an elasticity parameter to fall between 0, and 1, leave it unconstrained and give it a normal(0.5,0.5) prior distribution.
Warning: The parameter sigma has no priors.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  50% (4000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Messages received during sampling:</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.15666, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4.4e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.44 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.63469, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.533284, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.64268, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.20353, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.11721, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4.8e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.48 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -0.402845, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4.3e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.43 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.69687, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rejecting initial value:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Error evaluating the log probability at the initial value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -1.04511, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gradient evaluation took 4.2e-05 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1000 transitions using 10 leapfrog steps per transition would take 0.42 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Adjust your expectations accordingly!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Exception: lognormal_lpdf: Random variable is -12.5195, but must be nonnegative! (in &#39;/tmp/httpstan_trxd69w9/model_pmoxy2ci.stan&#39;, line 16, column 8 to column 31)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">posterioris_height_HPDIs_p1_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mu_HPDI_p1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">posteriori_HPDI_p1</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">for</span> <span class="n">weight_i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">):</span>
    <span class="n">posterioris_height_HPDIs_p1_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">alpha_p1</span> <span class="o">+</span> <span class="n">beta_p1</span> <span class="o">*</span> <span class="n">weight_i</span><span class="p">))</span>
    <span class="n">mu_HPDI_p1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">alpha_p1</span> <span class="o">+</span> <span class="n">beta_p1</span> <span class="o">*</span> <span class="n">weight_i</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">))</span>
    <span class="n">posteriori_HPDI_p1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">alpha_p1</span> <span class="o">+</span> <span class="n">beta_p1</span> <span class="o">*</span> <span class="n">weight_i</span><span class="p">,</span> <span class="n">sigma_p1</span><span class="p">),</span> <span class="mf">0.85</span><span class="p">))</span>
    
<span class="n">posterioris_height_HPDIs_p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mu_HPDI_p1</span><span class="p">)</span>
<span class="n">mu_HPDI_p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mu_HPDI_p1</span><span class="p">)</span>
<span class="n">posteriori_HPDI_p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">posteriori_HPDI_p1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==================================================</span>
<span class="c1">#     Comparativo dos tr√™s modelos polinomiais </span>
<span class="c1"># ==================================================</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># ===============================================================================</span>
<span class="c1">#     Plotando o gr√°fico de regress√£o polinomial de grau 1 - Modelo Linear</span>
<span class="c1"># ===============================================================================</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posterioris_height_HPDIs_p1_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">mu_HPDI_p1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mu_HPDI_p1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_HPDI_p1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_HPDI_p1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posterioris_height_HPDIs_p1_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regress√£o Polinomial de 1 Grau&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>


<span class="c1"># ===============================================================================</span>
<span class="c1">#     Plotando o gr√°fico de regress√£o polinomial de grau 2 - Par√°bola</span>
<span class="c1"># ===============================================================================</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial2_HPDI</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_sigma</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial2_sigma</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial2_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regress√£o Polinomial de 2 Grau&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="c1"># ===============================================================================</span>
<span class="c1">#     Plotando o gr√°fico de regress√£o polinomial de grau 3</span>
<span class="c1"># ===============================================================================</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial3_HPDI</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_sigma</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">posteriori_polinomial3_sigma</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">weight_full_std</span><span class="p">,</span> <span class="n">height_full</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">posteriori_polinomial3_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regress√£o Polinomial de 3 Grau&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altura (height)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso (weight)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="_images/Aula_2__week_4_52_1.png" src="_images/Aula_2__week_4_52_1.png" />
</div>
</div>
<p>O que fizemos aqui foi escolher uma forma matem√°tica (<em>um polin√¥mio de primeiro, de segundo e de terceiro grau</em>) e ajustarmos a melhor forma de cada um deles nos dados.</p>
<p>Como temos muitos dados, a nossa incerteza tende a ficar muito pequena o que pode nos levar a achar que o modelo est√° bem ajustado. As linhas n√£o endossa o modelo, o que faz mais sentido √© o modelo endossar as linhas.</p>
<p>Por isso temos que saber ser cr√≠ticos com os modelos e sobre a sua estrutura geral, por que o modelo nunca far√° isso por si mesmo. Ele n√£o tem responsabilidade e capacidade para fazer isso. √â de nossa responsabilidade fazer essa cr√≠tica, sen√£o iremos <em>destruir Praga</em>.</p>
<p>Podemos perceber que essas linhas n√£o se ajustam tamb√©m aos dados de modo geral, mas tamb√©m n√£o h√° muita incerteza de onde elas est√£o. Isso √© interessante, os intervalos de confiabilidade s√£o min√∫sculos mas o ajuste  nos dados foi um ajuste ruim, o modelo tem pouca incerteza mas √© um modelo ruim.</p>
<p>Outro problema dos polin√¥mios √© que ele n√£o s√£o monot√¥nicos, ou seja, depois de certo est√°gio eles tendem a seguir indefinidamente at√© o infinito. N√£o h√° oscila√ß√µes desse modelo.</p>
</div>
<div class="section" id="dores-dos-polinomios">
<h3>Dores dos Polin√¥mios<a class="headerlink" href="#dores-dos-polinomios" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>Polin√¥mios fazem previs√µes absurdas fora do range dos dados.</p></li>
<li><p>Os par√¢metros influenciam cada parte do corpo da curva, isso torna dif√≠cil de se entender.</p></li>
<li><p>N√£o s√£o muito flex√≠veis, n√£o podem ter curvas monot√¥nicas.</p></li>
</ul>
<p>Essas perdas de estabilidade tamb√©m podem ocorrer dentro do range dos dados, iremos ver bem mais para frente um exemplo disso.</p>
</div>
</div>
<div class="section" id="splines">
<h2>Splines<a class="headerlink" href="#splines" title="Permalink to this headline">¬∂</a></h2>
<a class="reference internal image-reference" href="_images/splines_boat.jpg"><img alt="splines in boat" src="_images/splines_boat.jpg" style="width: 1000px;" /></a>
<p>Ent√£o, o que fazer agora? Existem muitas outras op√ß√µes, a que vamos ver aqui √© uma que bastante comum e realmente √∫til no dia-a-dia. Mas, ainda assim, cont√≠nua sendo um modelo <em>geocentrico</em>. Assim como todos os outros modelos! Por isso, precisamos responsabilidade ter com o modelo e n√£o interpreta-lo demais.</p>
<p>As splines sugiram de uma motiva√ß√£o f√≠sica. <code class="docutils literal notranslate"><span class="pre">Spline</span></code> √© nome bastante estranho, mas √© apenas a barra na foto acima.  Essa barra √© recuada e fixada pontualmente (<em>pivot point</em>) pelos pesos de metal ao longo de seu comprimento. Vamos chamar esses pesos de <code class="docutils literal notranslate"><span class="pre">n√≥s</span></code> (<em><code class="docutils literal notranslate"><span class="pre">knots</span></code></em>). Essa estrutura ainda hoje √© usada por desenhistas para tra√ßar a curvas de um casco de barco.</p>
</div>
<div class="section" id="agindo-localmente-b-splines">
<h2>Agindo Localmente - <em>B-splines</em><a class="headerlink" href="#agindo-localmente-b-splines" title="Permalink to this headline">¬∂</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Splines</span> <span class="pre">de</span> <span class="pre">base</span></code>, ou no ingl√™s <em>basis-splines</em>, naturalmente s√£o chamadas de <code class="docutils literal notranslate"><span class="pre">B-splines</span></code>. S√£o fun√ß√µes todos seus par√¢metros tem efeitos apenas locais e n√£o globalmente como nos polin√¥mios. S√£o fun√ß√µes <em>wiggly</em>. Essa classe de fun√ß√µes s√£o constru√≠das com outras fun√ß√µes <em>wigglys</em> locais.</p>
<p>Vamos ver um exemplo, mas devemos sempre nos lembrar de que estamos construindo um modelo <em>geoc√™ntrico</em>, e que este est√° apenas descrevendo o comportamento dos dados na estrutura do nosso modelo e n√£o explicando eles. Iremos esses resultados para fazer previs√µes e, portanto, devemos ter responsabilidades sobre como funciona um modelo.</p>
<p><code class="docutils literal notranslate"><span class="pre">Fun√ß√µes</span> <span class="pre">de</span> <span class="pre">base</span></code>s√£o apenas fun√ß√µes locais, e toda a spline √© constru√≠da com interpola√ß√µes deslizando suavemente entre essas fun√ß√µes locais, ou seja, as fun√ß√µes de base (<em>basis functions</em>).</p>
<p>N√≥s iremos construir uma grande <em>wiggly functions</em> a partir de outras <em>wiggly functions</em> menores. Mas cada uma dessas fun√ß√µes wiggly menores tem par√¢metros locais que descrevem a sua import√¢ncia, n√≥s iremos ajust√°-los e poderemos observar que n√£o ocorrer√° aquelas oscila√ß√µes bruscas como ocorreu nas regress√µes polinomiais.</p>
<p>Esses modelos s√£o melhores do que os polin√¥mios, mas igualmente <em>geoc√™ntricos</em>.</p>
<p><code class="docutils literal notranslate"><span class="pre">B-Splines</span> <span class="pre">bayesianas</span></code> s√£o geralmente chamadas de <code class="docutils literal notranslate"><span class="pre">P-splines</span></code>. √â usado comumente em pessoas que usam machine learning. O <code class="docutils literal notranslate"><span class="pre">P</span></code> significa <em>penalidades</em> que a priori d√° para os pesos, mas rotulado dessa forma em contexto n√£o bayesianos.</p>
<p>Mais para frente no curso iremos ver melhor os conceitos de penalidades e ficar√° bem mais claro o uso.</p>
<p><code class="docutils literal notranslate"><span class="pre">B-splines</span></code> s√£o apenas apenas uma varia√ß√£o dos modelos lineares que vimos anteriormente. √â um modelo aditivo que tem algumas vari√°veis sint√©ticas estranhas (n√£o observ√°veis):</p>
<p>$$ \mu_i = \alpha + w_1B_{i, 1}+ w_2B_{i, 2}+ w_3B_{i, 3}+ ‚Ä¶  $$</p>
<p>Os pesos $w_i$ s√£o como as inclina√ß√µes. Isso √© meio estranho por que o preditor de interesse n√£o ir√° aparecer no modelo, no entanto, teremos uma aproxima√ß√£o fant√°stica da rela√ß√£o entre os preditores de interesse e o resultado. Parece estranho, mas funciona super bem.</p>
<p>As fun√ß√µes de bases (<em>basis functions</em>) $B$ s√£o vari√°veis sint√©ticas. Internamente elas s√£o termos quadr√°ticos ou termos c√∫bicos. Mas note que os dados n√£o foram usados para construir $B$. Os valores de $B$ associam pesos em diferentes regi√µes da vari√°vel $x$.</p>
<p>Vamos construir um exemplo, passo-a-passo, de como construir um modelos assim.</p>
</div>
<div class="section" id="festival-das-flores-de-cerejeira">
<h2>Festival das Flores de Cerejeira<a class="headerlink" href="#festival-das-flores-de-cerejeira" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="b-splines-do-clima">
<h3><em>B-splines</em> do Clima<a class="headerlink" href="#b-splines-do-clima" title="Permalink to this headline">¬∂</a></h3>
<a class="reference internal image-reference" href="_images/cherry_blossoms.jpg"><img alt="Cherry Blossoms" src="_images/cherry_blossoms.jpg" style="width: 1000px;" /></a>
<p>Cherry blossoms at Sugimura park, Hashimoto
<a class="reference external" href="https://en.wikipedia.org/wiki/Cherry_blossom">Wikipedia</a></p>
<p>Agora iremos usar os dados do hist√≥rico festival japones das flores de cerejeiras. O primeiro registro da uma flor de cerejeira nesse festival foi registrada a mais de $1200$ anos atr√°s e, agora, n√≥s temos esses dados abaixo para podermos explorar e entend√™-los melhor.</p>
<p>Nos dados temos a vari√°vel de tempo, <code class="docutils literal notranslate"><span class="pre">year</span></code>, correspondente a cada ano de coleta dos dados. Temos os dados da √©poca da flora√ß√£o e tamb√©m a temperatura de Mar√ßo. A temperatura influencia diretamente na flora√ß√£o das √°rvores pelo processo biol√≥gico natural.</p>
<p>Como podemos imaginar, essa rela√ß√£o √© afetada pelas oscila√ß√µes dos processos clim√°ticos ao longo dos anos. Por agora n√≥s iremos olhar para os dados da temperatura ao longo dos anos. Mas para frente ao longo do curso, iremos relacionar mais vari√°veis.</p>
<p>Fique como exerc√≠cio construir um modelo linear da <code class="docutils literal notranslate"><span class="pre">temperatura</span></code> explicando a <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">do</span> <span class="pre">florecimento</span></code> (<em>doy</em>), existe um relacionamento muito forte e entenderemos o porque disso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cherry_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/cherry_blossoms.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">cherry_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>doy</th>
      <th>temp</th>
      <th>temp_upper</th>
      <th>temp_lower</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1215.000000</td>
      <td>827.000000</td>
      <td>1124.000000</td>
      <td>1124.000000</td>
      <td>1124.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1408.000000</td>
      <td>104.540508</td>
      <td>6.141886</td>
      <td>7.185151</td>
      <td>5.098941</td>
    </tr>
    <tr>
      <th>std</th>
      <td>350.884596</td>
      <td>6.407036</td>
      <td>0.663648</td>
      <td>0.992921</td>
      <td>0.850350</td>
    </tr>
    <tr>
      <th>min</th>
      <td>801.000000</td>
      <td>86.000000</td>
      <td>4.670000</td>
      <td>5.450000</td>
      <td>0.750000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1104.500000</td>
      <td>100.000000</td>
      <td>5.700000</td>
      <td>6.480000</td>
      <td>4.610000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1408.000000</td>
      <td>105.000000</td>
      <td>6.100000</td>
      <td>7.040000</td>
      <td>5.145000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1711.500000</td>
      <td>109.000000</td>
      <td>6.530000</td>
      <td>7.720000</td>
      <td>5.542500</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2015.000000</td>
      <td>124.000000</td>
      <td>8.300000</td>
      <td>12.100000</td>
      <td>7.740000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cherry Blossom </span><span class="se">\n</span><span class="s1"> Festival das Flores de Cerejeiras no Jap√£o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperatura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_63_0.png" src="_images/Aula_2__week_4_63_0.png" />
</div>
</div>
<p>Nosso objetivo aqui √© construir uma tend√™ncia com esses registros de temperaturas, o que significa que queremos estimar uma spline para esses dados.</p>
<p>Se quisermos observar uma tend√™ncia em uma determinda escala para compar√°-l√°s a algum movimento, ent√£o iremos precisar contruir uma tend√™ncia em uma certa escala.</p>
<p>O que iremos fazer aqui √© trabalhar com a ideia de obter alguma aproxima√ß√£o da s√©rie com alguma qualidade arbitr√°ria. N√≥s iremos come√ßar com uma aproxima√ß√£o bastante ruim para entender as <em>wiggly functions</em> e ap√≥s isso iremos construir modelos mais complexos e com melhores aproxima√ß√µes usando uma <em><code class="docutils literal notranslate"><span class="pre">B-splines</span></code></em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===================================================</span>
<span class="c1">#     Gr√°fico de Primeiro dia de Flora√ß√£o x anos</span>
<span class="c1"># ===================================================</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">doy</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cherry Blossom </span><span class="se">\n</span><span class="s1"> Festival das Flores de Cerejeiras no Jap√£o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Primeiro dia de Flora√ß√£o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_65_0.png" src="_images/Aula_2__week_4_65_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="como-as-splines-funcionam">
<h2>Como as splines funcionam?<a class="headerlink" href="#como-as-splines-funcionam" title="Permalink to this headline">¬∂</a></h2>
<p>Aqui est√° um passo a passo de como construirmos uma splines.</p>
<ul class="simple">
<li><p><strong>Escolha alguns n√≥s (<em>knots</em>)</strong>: localiza√ß√£o da vari√°vel preditora onde a spline √© ancorada! Assim determinaremos o local onde aquelas pe√ßas pesadas ir√£o estar ao longo da barra de a√ßo. √â as pe√ßas pesada matem√°ticas onde os pontos de base fazem o piv√¥ e determinam as lacunas entre as splines de base.</p></li>
<li><p><strong>Escolha os graus da fun√ß√£o de base</strong>: O quanto √© <em>wiggly</em>. Iremos demonstrar gr√°ficamente esse a utiliza√ß√£o dos graus no decorrer da explica√ß√£o.</p></li>
<li><p><strong>Encontre a distribui√ß√£o posteriori dos pesos</strong>: Como anteriormente iremos fazer a estimativa bayesiana dos pesos, muito pr√≥ximos como fizemos nos modelos de regress√£o.</p></li>
</ul>
<div class="section" id="knots-como-escolher-os-pontos">
<h3>Knots - Como escolher os pontos?<a class="headerlink" href="#knots-como-escolher-os-pontos" title="Permalink to this headline">¬∂</a></h3>
<p>Exite uma grande literatura de abordagens de como devemos escolhermos os pontos. Uma dos m√©todos mais comuns e eficientes s√£o distribu√≠-los de acordo com seus <em>quantis</em>, pois assim podemos distribuir mais pontos onde h√° um ac√∫mulo maior dos dados. Geralmente pacotes e livrarias computacionais j√° nos trazem esses dados de modo autom√°tico e de uma certa forma m√°gicos. N√≥s iremos construir todo esse modelo manualmente para que entendermos os detalhes de seu funcionamento.</p>
<p>O que vamos propor √© colocar um <em>knot</em> na mediana, um <em>knot</em> em cada extremidade e outros dois no centros, conforme mostrado no gr√°fico abaixo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configurando a vari√°vel de tempo.</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span>

<span class="n">qty_knots</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Quantidade de n√≥s que iremos usar.</span>
<span class="n">knots_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">qty_knots</span><span class="p">)</span>

<span class="c1"># Ref: https://numpy.org/doc/stable/reference/generated/numpy.isfinite.html?highlight=isfinite#numpy.isfinite</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">year</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span>  <span class="c1"># Removendo os elementos NaN&#39;s</span>

<span class="c1"># Encontrando os knots tomando como base os quantiles</span>
<span class="n">knots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">knots_array</span><span class="p">)</span>
<span class="n">knots</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">knots</span><span class="p">]</span>  <span class="c1"># Convertendo os valores do Knots para inteiro</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">knots</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">knots</span><span class="p">))</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cherry Blossom </span><span class="se">\n</span><span class="s1"> Festival das Flores de Cerejeiras no Jap√£o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperatura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_69_0.png" src="_images/Aula_2__week_4_69_0.png" />
</div>
</div>
<p>Vamos agora construir as splines e os n√≥s (<em>knots</em>). Iremos desenhar abaixo todas as vari√°veis sint√©ticas. Os valores das vari√°veis sint√©ticas s√£o constru√≠das ao longo de todo intervalo da vari√°vel <code class="docutils literal notranslate"><span class="pre">ano</span></code>. E ent√£o queremos interpolar os dados.</p>
<p>Uma das maneiras de pensar a respeito disso √© pensar o ano como uma vari√°vel na qual nunca iremos usar novamente, usaremos apenas para definir os <em>knots</em> como √¢ncoras sobre alguns anos espec√≠ficos, mas nunca usaremos esses dados novamente.</p>
<p>Para come√ßar iremos construir algumas fun√ß√µes de base (<em>basis functions</em>). Vamos come√ßar com as fun√ß√µes de bases  mais simples, fun√ß√µes de base de grau 1, o que √© uma linha reta. Com isso iremos contruir uma <em>wiggly functions</em> composta de v√°rias func√µes de base de primeiro grau que s√£o as linhas retas.</p>
<a class="reference internal image-reference" href="_images/splines_2.jpg"><img alt="splines com pesos" src="_images/splines_2.jpg" style="width: 500px;" /></a>
<p><em>Os coment√°rios das fun√ß√µes tamb√©m ser√£o escritos em portugu√™s, assim como os textos e coment√°rios de linhas de c√≥digos est√£o sendo feitos. O objetivo agora √© facilitar a explica√ß√£o e n√£o colocar esses c√≥digo em produ√ß√£o! Mas algumas coisas podem ficar estranhas escritas em 2 linguas. Portanto, tentarei deixar o mais harmonioso poss√≠vel.</em>
:-)</p>
<p>Para a constru√ß√£o das splines, iremos usar a fun√ß√£o dispon√≠vel na biblioteca <em>SciKit Learn</em> e sua documenta√ß√£o pode ser acessada <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.SplineTransformer.html#examples-using-">clicando aqui.</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">SplineTransformer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_28930</span><span class="o">/</span><span class="mf">3000239018.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">SplineTransformer</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;sklearn&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ======================================</span>
<span class="c1">#     Construindo a Spline - Ordem 1</span>
<span class="c1"># ======================================</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">spline_1</span> <span class="o">=</span> <span class="n">SplineTransformer</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_knots</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># √â utilizado um intervalo equidistante entre os quantis, por padr√£o. </span>
<span class="n">spline_1</span> <span class="o">=</span> <span class="n">spline_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spline_1</span><span class="p">)</span>

<span class="n">marco_eixo_x</span> <span class="o">=</span> <span class="mi">1306</span>  <span class="c1"># Local no eixo X que a linha tracejada ser√° plotada</span>
<span class="n">marco_eixo_y_cima</span> <span class="o">=</span> <span class="n">spline_1</span><span class="p">[</span><span class="n">marco_eixo_x</span> <span class="o">-</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">marco_eixo_y_baixo</span> <span class="o">=</span> <span class="n">spline_1</span><span class="p">[</span><span class="n">marco_eixo_x</span> <span class="o">-</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">marco_eixo_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># Linha tracejada vertical</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marco_eixo_x</span><span class="p">,</span> <span class="n">marco_eixo_y_cima</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Ponto de marca√ß√£o de cima</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marco_eixo_x</span><span class="p">,</span> <span class="n">marco_eixo_y_baixo</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Ponto de marca√ß√£o de baixo</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">marco_eixo_x</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">marco_eixo_x</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;B-Splines de grau 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Anos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">780</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span><span class="s1">&#39;$Knot_1$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span><span class="s1">&#39;$Knot_2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1370</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span><span class="s1">&#39;$Knot_3$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1670</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span><span class="s1">&#39;$Knot_4$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1940</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span><span class="s1">&#39;$Knot_5$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_75_0.png" src="_images/Aula_2__week_4_75_0.png" />
</div>
</div>
<p>Assim como as splines para os desenhistas como na imagens acima, n√≥s, estat√≠sticos, usamos elas de modo semelhantes em matem√°tica. No gr√°fico acima plotamos $5$ fun√ß√µes de bases (<em>basis-function</em>) tendo como ponto central os n√≥s (<em>knots</em>) que definimos anteriormente.</p>
<p>Para entendermos o funcionamento dessa estrutura, temos que perceber 2 coisas: Os dois pontos pretos que est√£o plotados no gr√°fico acima, esses pontos sempre estar√£o sobre 2 func√µes de base, como por exemplo na fun√ß√£o referente ao n√≥ 2 <em>($knot_2$)</em> e ao n√≥ 3 <em>($knot_3$)</em>. Isso sempre ser√° verdade, exceto quando a posi√ß√£o do <code class="docutils literal notranslate"><span class="pre">eixo</span> <span class="pre">x</span></code> estiver exatamente sobre a posi√ß√£o de alguns do n√≥s.</p>
<p>A pr√≥xima observa√ß√£o √© que cada uma das fun√ß√µes de base ser√° multiplicada por um n√∫mero, esse n√∫mero ir√° modificar a sua estrutura podendo aumenta-l√° ou a encurtar. Esse peso, como veremos mais adiante, ser√° rotulado de $w$. Assim, ap√≥s essa modifica√ß√£o ser aplicada em todas as curvas, iremos somar todos os pontos pretos e obteremos a nossa <em>B-spline</em>, ou seja, uma nova curva que √© a resultante da soma de todas as curvas multiplicada por ser respectivos pesos.</p>
<p>O interessante que notamos aqui √© que, na regress√£o polinomial usamos as vari√°veis explicativas (<em>$X$</em>) da nossa amostra com alguns ajustes, elevado ao quadrado ou elevado ao cubo, para constru√ß√£o do nosso modelo. No modelo de splines que iremos construir, a vari√°vel explicativa √© uma vari√°vei sint√©tica, ou seja, uma vari√°vel que n√≥s criamos e que n√£o tem nenhuma rela√ß√£o com o modelo em si.</p>
<p>O que buscamos com o modelo de splines √© estimar <strong>quais seriam os pesos mais plaus√≠veis</strong> que melhor descreve nossos dados. Parece muito estranho fazer isso, mais funciona muito bem! Vamos ver um exemplo de como isso acontece.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma da Temperatura do per√≠odo de Flora√ß√£o das Cerejeiras&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperatura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequ√™ncias&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_77_0.png" src="_images/Aula_2__week_4_77_0.png" />
</div>
</div>
<p>Com as splines definidas acima, iremos construir nosso modelo em <em>Stan</em> para estimar a temperatura em cada ano da flora√ß√£o das cerejeiras. Iremos supor que a temperatura √© distribu√≠da normalmente, conforme gr√°fico acima.</p>
<p>O modelo matem√°tico ser√° descrito como:</p>
<p>$$ temperatura \sim normal(\mu, \sigma) $$</p>
<p>no qual a m√©dia, $\mu$, ser√° constru√≠da da seguinte forma:</p>
<p>$$ \mu = \alpha + w_1  B_{i, 1} + w_2  B_{i, 2} + w_3  B_{i, 3} + w_4  B_{i, 4} +  w_5  B_{i, 5}$$</p>
<p>Para evitarmos de termos que escrever todos os termos na m√£o dentro da <em>stan</em>, podemos reescrever a equa√ß√£o acima da seguinte forma:</p>
<p>$$ \mu = \alpha + w_k  B_{i, k} $$</p>
<p>Essa nota√ß√£o matem√°tica converte a equa√ß√£o acima para uma simples multiplica√ß√£o de matrizes, conforme vimos no ensino m√©dio, e assim, tanto evitamos reescrever todos os termos manualmente quanto conseguirmos otimizar os custos computacionais envolvidos nos c√°lculos. (<em>Geralmente √© sempre uma boa ideia utilizar matrizes.</em>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==================================</span>
<span class="c1">#   Construindo o modelo b-spline</span>
<span class="c1"># ==================================</span>

<span class="n">model_spline_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data {</span>
<span class="s2">        int&lt;lower=0&gt; N;  // N√∫mero de observa√ß√µes</span>
<span class="s2">        int&lt;lower=0&gt; K;  // N√∫mero de Knots</span>
<span class="s2">        matrix[N, K] B;  // B-splines</span>
<span class="s2">        vector[N] temp;  // Vari√°vel resposta (y)</span>
<span class="s2">    }</span>

<span class="s2">    parameters {</span>
<span class="s2">        real&lt;lower=0&gt; sigma;</span>
<span class="s2">        real alpha;</span>
<span class="s2">        vector[K] w;  // Pesos</span>
<span class="s2">    }</span>

<span class="s2">    model {</span>
<span class="s2">        alpha ~ normal(100, 10);  // Priori para alpha</span>
<span class="s2">        w ~ normal(0, 1);         // Priori para w</span>
<span class="s2">        sigma ~ exponential(1);   // Priori para sigma</span>
<span class="s2">        </span>
<span class="s2">        temp ~ normal(alpha + B * w, sigma);  // Verossimilhan√ßas (Likelohood)</span>
<span class="s2">    }</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spline_1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># N√∫mero de amostras</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spline_1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># N√∫mero de n√≥s (knots)</span>

<span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
    <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">spline_1</span><span class="p">),</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="c1"># Colocando os valores NA como m√©dia da s√©rie.</span>
<span class="p">}</span>

<span class="n">posteriori_spline_1</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_spline_1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dados</span><span class="p">)</span>
<span class="n">fit_spline_1</span> <span class="o">=</span> <span class="n">posteriori_spline_1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">alpha_spline_1</span> <span class="o">=</span> <span class="n">fit_spline_1</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span>
<span class="n">w_spline_1</span> <span class="o">=</span> <span class="n">fit_spline_1</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span>
<span class="n">sigma_spline_1</span> <span class="o">=</span> <span class="n">fit_spline_1</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">Bw_spline_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">spline_1</span><span class="p">,</span> <span class="n">w_spline_1</span><span class="p">)</span>  <span class="c1"># Fazendo a multiplica√ß√£o das matrizes B * w </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
<span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
Warning in &#39;/tmp/httpstan_vg7jd5_2/model_gujiwcol.stan&#39;, line 16, column 23: Argument 100 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
<span class=" -Color -Color-Cyan">Sampling:</span>   0%
<span class=" -Color -Color-Cyan">Sampling:</span>   1% (100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   2% (200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   4% (300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   5% (400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   6% (500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   9% (700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  12% (1000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  14% (1100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  15% (1200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  16% (1300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  19% (1500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  21% (1700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  24% (1900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  28% (2200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  30% (2400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  31% (2500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  35% (2800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  39% (3101/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  54% (4301/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  73% (5801/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  88% (7001/8000)
<span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
<span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
<span class=" -Color -Color-Cyan">Messages received during sampling:</span>
  Gradient evaluation took 6.8e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.68 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 6e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.6 seconds.
  Adjust your expectations accordingly!
  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
  Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/httpstan_fatjhom7/model_gujiwcol.stan&#39;, line 20, column 8 to column 44)
  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
  Gradient evaluation took 5.7e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.57 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 9e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.9 seconds.
  Adjust your expectations accordingly!
  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
  Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/httpstan_fatjhom7/model_gujiwcol.stan&#39;, line 20, column 8 to column 44)
  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
</pre></div>
</div>
</div>
</div>
<p>Com o modelo ajustado, temos a estimativa do par√¢metro $w$, que s√£o os pesos de cada uma das fun√ß√µes de base. Para sabermos qual o efeito gerado de cada um desses pesos aplicados ao nas fun√ß√µes, multiplicamos ambos:</p>
<p>$$ \mbox{Bw_spline_1} = w_k B_{i, k} $$</p>
<p>O resultado dessa opera√ß√£o pode ser visto no gr√°fico abaixo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ====================================================</span>
<span class="c1">#    Plot da Posteriori do Mu da B-Spline de Grau 1</span>
<span class="c1"># ====================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>  <span class="n">Bw_spline_1</span><span class="p">,</span>  <span class="c1"># Plot do B * w</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$B*w$ da B-Spline&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$B*w$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">780</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span><span class="s1">&#39;$Knot_1$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span><span class="s1">&#39;$Knot_2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1370</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span><span class="s1">&#39;$Knot_3$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1670</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span><span class="s1">&#39;$Knot_4$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1940</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span><span class="s1">&#39;$Knot_5$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_81_0.png" src="_images/Aula_2__week_4_81_0.png" />
</div>
</div>
<p>Para conseguirmos verificar a estimativa da temperatura de modo visual, somaremos ao valor de <code class="docutils literal notranslate"><span class="pre">Bw_spline_1</span></code> o valor <code class="docutils literal notranslate"><span class="pre">alpha_spline_1</span></code>, que √© a estimativa do valor m√©dio da temperatura. Veja a seguir o gr√°fico.</p>
<p>Assim como em outros modelos anteriores, temos a regi√£o de plausibilidade dada pelas retas em cada um do n√≥s. Apesar de termos apenas $5$ n√≥s, a estimativa para $\mu$ √© muito boa.</p>
<p>Para termos uma estimativa mais detalhada, devemos aumentar o n√∫mero de n√≥s e tamb√©m alterar o grau das fun√ß√µes de bases usada. Quando maior o n√∫mero de n√≥s e, tamb√©m, maior o n√∫mero do grau das fun√ß√µes de base, tendemos a ter um ajuste mais preciso.</p>
<p>Um ajuste preciso pode ser preocupante e estragar nosso dia, o motivo disso √© um efeito conhecido como <code class="docutils literal notranslate"><span class="pre">overffiting</span></code>. Iremos tratar disso mais adiante, mas de modo geral <em>overffting</em>, ou sobreajuste, √© a capacidade do modelo identificar detalhes minuciosos na amostra mas n√£o consegue ser bom em identificar os detalhes na popula√ß√£o. Por enquanto, iremos apenas entender como √© o funcionamento de uma spline e em cap√≠tulos posteriores, veremos mais detalhes sobre o fantasma do <code class="docutils literal notranslate"><span class="pre">overffiting</span></code> em nossos modelo.</p>
<a class="reference internal image-reference" href="_images/overffiting.jpg"><img alt="overffiting example" src="_images/overffiting.jpg" style="width: 500px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ======================================================</span>
<span class="c1">#    Plot da Posteriori de mu da B-Spline de Grau 1</span>
<span class="c1"># ======================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">n_plot</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Define a quantidade de simula√ß√µes para o plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># Plot da amostra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">alpha_spline_1</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">]</span> <span class="o">+</span> <span class="n">Bw_spline_1</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">],</span>  <span class="c1"># mu</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posteriori de mu da B-Spline&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu$ </span><span class="se">\n</span><span class="s1"> (Temperatura de Mar√ßo)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">780</span><span class="p">,</span>  <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_1$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1370</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_3$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1670</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_4$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1940</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_5$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_84_0.png" src="_images/Aula_2__week_4_84_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================================</span>
<span class="c1">#      Reamostragem da Posteriori B-Spline de Grau 1 </span>
<span class="c1"># ==========================================================</span>

<span class="n">posteriori_spline_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">alpha_spline_1</span> <span class="o">+</span> <span class="n">Bw_spline_1</span><span class="p">,</span> <span class="n">sigma_spline_1</span><span class="p">)</span>  <span class="c1"># Amostras normal(mu, sigma)</span>

<span class="n">intervalo_credibilidade</span> <span class="o">=</span> <span class="mf">0.88</span>  <span class="c1"># Intervalo de credibilidade - HPDI</span>

<span class="n">HPDI_posteriori_spline_1</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Vetor do HPDI</span>

<span class="k">for</span> <span class="n">year_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">posteriori_spline_1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># OBS: Essa opera√ß√£o √© um pouco demorada. </span>
    <span class="n">HPDI_posteriori_spline_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posteriori_spline_1</span><span class="p">[</span><span class="n">year_i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">intervalo_credibilidade</span><span class="p">))</span>

<span class="n">HPDI_posteriori_spline_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">HPDI_posteriori_spline_1</span><span class="p">)</span>
<span class="n">mean_posteriori_spline_1</span> <span class="o">=</span> <span class="n">posteriori_spline_1</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># M√©dia do HPDI por cada ano</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===============================================</span>
<span class="c1">#    Plot da Posteriori da B-Spline de Grau 1</span>
<span class="c1"># ===============================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># Plot da amostra</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">HPDI_posteriori_spline_1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">HPDI_posteriori_spline_1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Plot HPDI</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HPDI da Posteriori&#39;</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">mean_posteriori_spline_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M√©dia da posteriori&#39;</span><span class="p">)</span>  <span class="c1"># Plot da M√©dia</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">alpha_spline_1</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">]</span> <span class="o">+</span> <span class="n">Bw_spline_1</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">],</span>  <span class="c1"># Plot do Intevalo da M√©dia (Sem o HPDI)</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posteriori da B-Spline </span><span class="se">\n</span><span class="s1"> HPDI de &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">intervalo_credibilidade</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Posteriori </span><span class="se">\n</span><span class="s1"> (Temperatura de Mar√ßo)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">780</span><span class="p">,</span>  <span class="mf">7.7</span><span class="p">,</span><span class="s1">&#39;$Knot_1$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span><span class="s1">&#39;$Knot_2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1370</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span><span class="s1">&#39;$Knot_3$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1670</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span><span class="s1">&#39;$Knot_4$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span><span class="s1">&#39;$Knot_5$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_86_0.png" src="_images/Aula_2__week_4_86_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ======================================</span>
<span class="c1">#      Construindo a Spline - Ordem 3</span>
<span class="c1"># ======================================</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">spline_3</span> <span class="o">=</span> <span class="n">SplineTransformer</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_knots</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># √â utilizado um intervalo equidistante entre os quantis, por padr√£o. </span>
<span class="n">spline_3</span> <span class="o">=</span> <span class="n">spline_3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spline_3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;B-Splines de grau 3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Anos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_87_0.png" src="_images/Aula_2__week_4_87_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =======================================================</span>
<span class="c1">#   Construindo o modelo b-spline de grau 3 com 15 n√≥s</span>
<span class="c1"># =======================================================</span>

<span class="c1"># Perceba que o modelo de grau 3 ter√° a mesma estrutura do modelo de grau 1 </span>
<span class="n">model_spline_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data {</span>
<span class="s2">        int&lt;lower=0&gt; N;  // N√∫mero de observa√ß√µes</span>
<span class="s2">        int&lt;lower=0&gt; K;  // N√∫mero de Knots</span>
<span class="s2">        matrix[N, K] B;  // B-splines</span>
<span class="s2">        vector[N] temp;  // Vari√°vel resposta (y)</span>
<span class="s2">    }</span>

<span class="s2">    parameters {</span>
<span class="s2">        real&lt;lower=0&gt; sigma;</span>
<span class="s2">        real alpha;</span>
<span class="s2">        vector[K] w;  // Pesos</span>
<span class="s2">    }</span>

<span class="s2">    model {</span>
<span class="s2">        alpha ~ normal(100, 10);  // Priori para alpha</span>
<span class="s2">        w ~ normal(0, 1);         // Priori para w</span>
<span class="s2">        sigma ~ exponential(1);   // Priori para sigma</span>
<span class="s2">        </span>
<span class="s2">        temp ~ normal(alpha + B * w, sigma);  // Verossimilhan√ßas (Likelohood)</span>
<span class="s2">    }</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spline_3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># N√∫mero de amostras</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">spline_3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># N√∫mero de n√≥s (knots)</span>

<span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
    <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">spline_3</span><span class="p">),</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="c1"># Colocando os valores NA como m√©dia da s√©rie.</span>
<span class="p">}</span>

<span class="n">posteriori_spline_3</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_spline_3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dados</span><span class="p">)</span>
<span class="n">fit_spline_3</span> <span class="o">=</span> <span class="n">posteriori_spline_3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">alpha_spline_3</span> <span class="o">=</span> <span class="n">fit_spline_3</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span>
<span class="n">w_spline_3</span> <span class="o">=</span> <span class="n">fit_spline_3</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span>
<span class="n">sigma_spline_3</span> <span class="o">=</span> <span class="n">fit_spline_3</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">Bw_spline_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">spline_3</span><span class="p">,</span> <span class="n">w_spline_3</span><span class="p">)</span>  <span class="c1"># Fazendo a multiplica√ß√£o das matrizes B * w</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
<span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
Warning in &#39;/tmp/httpstan_vg7jd5_2/model_gujiwcol.stan&#39;, line 16, column 23: Argument 100 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
<span class=" -Color -Color-Cyan">Sampling:</span>   0%
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (1/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (2/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (3/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (4/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   1% (103/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   3% (202/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   4% (301/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   5% (400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   6% (500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   8% (600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   9% (700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  10% (800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  12% (1000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  14% (1100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  15% (1200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  16% (1300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  18% (1400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  19% (1500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  20% (1600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  21% (1700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  22% (1800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  24% (1900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  28% (2200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  29% (2300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  31% (2500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  32% (2600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  34% (2700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  35% (2800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  36% (2900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  38% (3000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  40% (3201/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  43% (3401/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  46% (3701/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  63% (5001/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  86% (6900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  98% (7800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
<span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
<span class=" -Color -Color-Cyan">Messages received during sampling:</span>
  Gradient evaluation took 4.7e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.47 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 4.3e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.43 seconds.
  Adjust your expectations accordingly!
  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
  Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/httpstan_fatjhom7/model_gujiwcol.stan&#39;, line 20, column 8 to column 44)
  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
  Gradient evaluation took 5.9e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.59 seconds.
  Adjust your expectations accordingly!
  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
  Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/httpstan_fatjhom7/model_gujiwcol.stan&#39;, line 20, column 8 to column 44)
  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
  Gradient evaluation took 4.9e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.49 seconds.
  Adjust your expectations accordingly!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ====================================================</span>
<span class="c1">#    Plot da Posteriori do Mu da B-Spline de Grau 3</span>
<span class="c1"># ====================================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>  <span class="n">Bw_spline_3</span><span class="p">,</span>  <span class="c1"># Plot do B * w</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 
 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$B*w$ da B-Spline grau 3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$B*w$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_89_0.png" src="_images/Aula_2__week_4_89_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================================</span>
<span class="c1">#      Reamostragem da Posteriori B-Spline de Grau 3 </span>
<span class="c1"># ==========================================================</span>

<span class="n">posteriori_spline_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">alpha_spline_3</span> <span class="o">+</span> <span class="n">Bw_spline_3</span><span class="p">,</span> <span class="n">sigma_spline_3</span><span class="p">)</span>  <span class="c1"># Amostras normal(mu, sigma)</span>

<span class="c1"># Intervalo de credibilidade - HPDI</span>
<span class="c1">#  Lembre-se: a velocidade do c√°lculo do HPDI √© t√£o mais r√°pido quando </span>
<span class="c1">#             mais pr√≥ximo de 1 estiver o valor do intervalo_credibilidade</span>
<span class="c1">#  Altere esses valores para perceber a abertura do intevalo de credibilidade sobre os dados.</span>
<span class="n">intervalo_credibilidade</span> <span class="o">=</span> <span class="mf">0.89</span>

<span class="n">HPDI_posteriori_spline_3</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Vetor do HPDI</span>

<span class="k">for</span> <span class="n">year_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">posteriori_spline_3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># XXX: Essa opera√ß√£o √© um pouco demorada. </span>
    <span class="n">HPDI_posteriori_spline_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HPDI</span><span class="p">(</span><span class="n">posteriori_spline_3</span><span class="p">[</span><span class="n">year_i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">intervalo_credibilidade</span><span class="p">))</span>

<span class="n">HPDI_posteriori_spline_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">HPDI_posteriori_spline_3</span><span class="p">)</span>
<span class="n">mean_posteriori_spline_3</span> <span class="o">=</span> <span class="n">posteriori_spline_3</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># M√©dia do HPDI por cada ano</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ===============================================</span>
<span class="c1">#    Plot da Posteriori da B-Spline de Grau 3</span>
<span class="c1"># ===============================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">cherry_df</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># Plot da amostra</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">HPDI_posteriori_spline_3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">HPDI_posteriori_spline_3</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Plot HPDI</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HPDI da Posteriori&#39;</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">mean_posteriori_spline_3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M√©dia da posteriori&#39;</span><span class="p">)</span>  <span class="c1"># Plot da M√©dia</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cherry_df</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">alpha_spline_3</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">]</span> <span class="o">+</span> <span class="n">Bw_spline_3</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_plot</span><span class="p">],</span>  <span class="c1"># Plot do Intevalo da M√©dia (Sem o HPDI)</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posteriori da B-Spline </span><span class="se">\n</span><span class="s1"> HPDI de &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">intervalo_credibilidade</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ano&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Posteriori </span><span class="se">\n</span><span class="s1"> (Temperatura de Mar√ßo)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="s1">&#39;Um problema que pode acontecer </span><span class="se">\n</span><span class="s1"> quando geramos a spline com a </span><span class="se">\n</span><span class="s1"> √∫ltima e a primeira ponta da fun√ß√£o </span><span class="se">\n</span><span class="s1"> &quot;presa&quot;.&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Aula_2__week_4_91_0.png" src="_images/Aula_2__week_4_91_0.png" />
</div>
</div>
</div>
<div class="section" id="possibilidades-das-splines">
<h3>Possibilidades das Splines<a class="headerlink" href="#possibilidades-das-splines" title="Permalink to this headline">¬∂</a></h3>
<ul class="simple">
<li><p>A quantidade de n√≥s e os graus da fun√ß√µes de base s√£o nossa escolhas</p></li>
</ul>
<p>Exitem muitas diferente maneiras de se definir uma spline, assim como existem muitos outros tipos de splines. As que vimos aqui foram as splines mais simples.</p>
<p>Obs: No curso a defini√ß√£o das b-splines s√£o um pouco diferente das que usamos aqui. Para saber com √© o formato das fun√ß√µes que o Richard usa ver a aula <a class="reference external" href="https://www.youtube.com/watch?v=ENxTrFf9a7c&amp;list=PLDcUM9US4XdNM4Edgs7weiyIguLSToZRI">Statistical Rethinking Winter 2019 Lecture 04</a> a partir dos 57 minutos.</p>
<ul class="simple">
<li><p>Devemos nos preocupar com o overfitting dos dados (Veremos isso no cap√≠puto 7).</p></li>
<li><p>Outros tipos de splines n√£o precisam de n√≥s (<em>knots</em>)</p></li>
<li><p>Uma outra ideia de aproxima√ß√£o que veremos no cap√≠tulo 14 ser√° as ideias dos <code class="docutils literal notranslate"><span class="pre">Processos</span> <span class="pre">Gaussianos</span></code>.</p></li>
<li><p>Todas as splines s√£o descritivas e n√£o mecanicista.</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Rodolpho Macedo dos Santos<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>