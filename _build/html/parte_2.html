
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2 - Engenharia de Golems &#8212; Statistical Rethinking</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3- Modelos Geocêntricos" href="parte_3.html" />
    <link rel="prev" title="1- Introdução" href="parte_1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Statistical Rethinking</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="capa.html">
   Estatistica Bayesiana
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro_pt-BR.html">
   Intro - Estatística Bayesiana (🇧🇷)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_en.html">
   Intro - Bayesian Statistics (🇺🇸)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parte_1.html">
   1- Introdução
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2 - Engenharia de Golems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parte_3.html">
   3- Modelos Geocêntricos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parte_4.html">
   4 - Funções Wiggly
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parte_5.html">
   5 - Muitas Variáveis e os Waffles Espúrios
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/parte_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rodolphomacedo/statistical_rethinking_pt_BR"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rodolphomacedo/statistical_rethinking_pt_BR/issues/new?title=Issue%20on%20page%20%2Fparte_2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rodolphomacedo/statistical_rethinking_pt_BR/main?urlpath=tree/parte_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   2 - Engenharia de Golems
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#condicionando-o-modelo-aos-dados">
   Condicionando o modelo aos dados
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#criticando-o-modelo">
   Criticando o modelo
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construindo-o-framework-de-causalidade">
   Construindo o framework de causalidade
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definicao-de-w">
     Definição de
     <em>
      W
     </em>
     :
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribuicao-de-w-verossimilhanca">
     Distribuição de W (
     <em>
      Verossimilhança
     </em>
     )
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probabilidade-priori-p">
     Probabilidade
     <em>
      Priori
     </em>
     (
     <span class="math notranslate nohighlight">
      \(p\)
     </span>
     )
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#definindo-uma-linguagem">
       Definindo uma linguagem
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probabilidade-a-posteriori">
     Probabilidade à Posteriori
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#posteriori-priori-e-verossimilhanca">
   Posteriori, Priori e Verossimilhança
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculo-da-posteriori">
     Cálculo da Posteriori
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#via-grade-de-aproximacao-grid-approximation">
       Via Grade de Aproximação (
       <em>
        Grid Approximation
       </em>
       )
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amostras-a-partir-da-posteriori">
   Amostras a partir da Posteriori
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculando-coisas-com-a-nossa-amostra-da-posteriori">
     Calculando coisas com a nossa amostra da Posteriori
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#falando-um-pouco-sobre-intervalos">
     Falando um pouco sobre intervalos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#checagem-da-predicao-do-modelo">
       Checagem da predição do modelo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vamos-entender-como-fazer-simulacoes-a-partir-da-posteriori">
       Vamos entender como fazer simulações a partir da posteriori
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resumo">
   Resumo
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="engenharia-de-golems">
<h1>2 - Engenharia de Golems<a class="headerlink" href="#engenharia-de-golems" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://www.youtube.com/watch?v=XoVtOAN0htU">Aula - Statistical Rethinking Winter 2019 Lecture 02</a></p>
<p>Esse capítulo terá
dois objetivos principais:</p>
<ol class="simple">
<li><p>Construir a intuição de como a atualização funciona, ou seja, como os Golems <code class="docutils literal notranslate"><span class="pre">aprendem</span> <span class="pre">com</span> <span class="pre">a</span> <span class="pre">experiência.</span></code></p></li>
<li><p>Apresentar uma intuição sobre <code class="docutils literal notranslate"><span class="pre">como</span> <span class="pre">construir</span> <span class="pre">esses</span> <span class="pre">modelos.</span></code></p></li>
</ol>
<p>Como iremos usar a probabilidade para fazer um típico modelo estatístico?</p>
<ol class="simple">
<li><p><strong>Design o modelo</strong>: Usando uma base científica e procurando de onde os dados nascem.</p></li>
<li><p><strong>Condicionar aos dados</strong>: Atualização dos modelos com os dados. Na atualização bayesiana temos apenas <code class="docutils literal notranslate"><span class="pre">um</span> <span class="pre">modo</span> <span class="pre">de</span> <span class="pre">fazer</span> <span class="pre">isso</span></code>, pois há apenas <code class="docutils literal notranslate"><span class="pre">um</span> <span class="pre">tipo</span> <span class="pre">de</span> <span class="pre">estimador</span> <span class="pre">bayesiano</span></code>.</p></li>
<li><p><strong>Avaliar como está o modelo</strong>: Temos que ser críticos com o nosso modelo, por causa da distinção entre o pequeno <code class="docutils literal notranslate"><span class="pre">mundo</span> <span class="pre">de</span> <span class="pre">Colombo</span></code> e o <code class="docutils literal notranslate"><span class="pre">Mundo</span> <span class="pre">Real</span></code>.</p></li>
</ol>
<p><strong>Exemplo</strong>: Como é feito o processo da criação dos dados?</p>
<p>No curso, o prof. Richard lançou um Globo Terrestre para os alunos. Cada aluno que segurou o globo deveria observar, em sua mão direita, se seu <code class="docutils literal notranslate"><span class="pre">dedo</span> <span class="pre">indicador</span></code> estava sobre algum dos oceanos (representado como <span class="math notranslate nohighlight">\(W\)</span>, <em>water</em>) ou sobre a terra (<span class="math notranslate nohighlight">\(L\)</span>, <em>land</em>), e registrar esses dados.</p>
<p>Esse é o processo de como os dados estão nascendo!</p>
<p>Suponha que a partir dos lançamentos, nós obtemos a sequência:</p>
<div class="math notranslate nohighlight">
\[ [W, L, W, W, W, L, W, L, W] \]</div>
<p>O que iremos fazer aqui é estimar <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">proporção</span> <span class="pre">da</span> <span class="pre">superfície</span> <span class="pre">da</span> <span class="pre">Terra</span> <span class="pre">que</span> <span class="pre">contém</span> <span class="pre">água</span></code>.</p>
<a class="reference internal image-reference" href="_images/earth.jpg"><img alt="_images/earth.jpg" src="_images/earth.jpg" style="width: 1000px;" /></a>
<hr class="docutils" />
<div class="admonition-pare-pensar-antes-de-continuar admonition">
<p class="admonition-title">Pare pensar antes de continuar:</p>
<p>Qual é o número de vezes que precisamos jogar o globo, para obter uma certa precisão da estimativa da proporção de água na superfície do planeta?</p>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Alterando a cor de fundo, para ficar mais elegante.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lightgray&#39;</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Design do Modelo</span>

<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="c1"># Amostra a partir dos lançamentos do globo.</span>

<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span>  <span class="c1"># Transformando os dados em números. [1 = W; 0 = L]</span>
</pre></div>
</div>
</div>
</div>
<p>Quando o globo foi lançado, a probabilidade do dedo indicador “cair na água”, em qualquer um dos lançamentos, deveria ser proporcional a proporção de água que tem na superfície do planeta. Isso é como jogar uma moeda para sortear cara ou coroa. Mas uma moeda com muitos lados. <code class="docutils literal notranslate"><span class="pre">O</span> <span class="pre">ambiente</span> <span class="pre">é</span> <span class="pre">determinístico,</span> <span class="pre">porém</span> <span class="pre">caótico</span> <span class="pre">para</span> <span class="pre">nós</span></code>. Assim, pequenas diferenças nas condições iniciais, geram resultados essencialmente aleatórios.</p>
<p>Para nós, na escala em que vivemos, o ambiente é determinístico. Mas é um sistema caótico e, portanto, aleatório. Pois não temos a capacidade de compreender o sistema todo e, por isso, somos ignorantes a seu respeito.</p>
<p>O simples lançamento de moedas, para nós, é considerado um bom sistema de aleatorização. Não podemos medir a velocidade inicial e também a posição do giro bem o suficiente para prever como cairá a moeda, <code class="docutils literal notranslate"><span class="pre">essa</span> <span class="pre">é</span> <span class="pre">a</span> <span class="pre">única</span> <span class="pre">razão</span></code>!</p>
<p>Então dizemos que há um número aleatório que gerado, mas que a proporção dele deve ter uma probabilidade <span class="math notranslate nohighlight">\(p\)</span> da superfície da Terra ser coberta por água.</p>
<p>Onde <span class="math notranslate nohighlight">\(p\)</span> é a proporção de água que cobre a superfície da Terra. Por isso <code class="docutils literal notranslate"><span class="pre">não</span> <span class="pre">importa</span> <span class="pre">a</span> <span class="pre">ordem</span> <span class="pre">dos</span> <span class="pre">lançamentos</span></code>, já que a probabilidade se mantém a mesma durante todo o processo de amostragem.</p>
<p>Essa é uma suposição, precisamos demonstrar e sermos críticos com relação a isso. Em capítulos futuros iremos aprender como fazer um cálculo para inspecionar essa suposição.</p>
<p>Esse é um dos exemplos mais simples que podemos iniciar a nossa apresentação de como construir um <code class="docutils literal notranslate"><span class="pre">modelo</span> <span class="pre">bayesiano</span></code>.</p>
<p>Em comparação com o exemplo anterior, a bolsa que contém quarto bolinhas coloridas, esse exemplo pode ser imaginado também como uma bolsa (ou seja, o <code class="docutils literal notranslate"><span class="pre">planeta</span> <span class="pre">é</span> <span class="pre">uma</span> <span class="pre">bolsa</span></code>) e que contém a quantidade <code class="docutils literal notranslate"><span class="pre">infinitas</span> <span class="pre">bolinhas</span></code> (ou seja, todo o par de <code class="docutils literal notranslate"><span class="pre">*latitude*</span></code> e <code class="docutils literal notranslate"><span class="pre">*longitute*</span></code> é representando como uma bolinha dentro da bolsa). E, assim como na bolsa, o planeta tem dois tipos de bolinhas coloridas: bolas <span class="math notranslate nohighlight">\(Azuis\)</span> e bolas <span class="math notranslate nohighlight">\(Brancas\)</span>, ou melhor, <code class="docutils literal notranslate"><span class="pre">Água</span> <span class="pre">(W)</span></code> e <code class="docutils literal notranslate"><span class="pre">Terra</span> <span class="pre">(L)</span></code>,</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="condicionando-o-modelo-aos-dados">
<h1>Condicionando o modelo aos dados<a class="headerlink" href="#condicionando-o-modelo-aos-dados" title="Permalink to this headline">¶</a></h1>
<p>Nessa parte, iremos passar por três processos:</p>
<ul class="simple">
<li><p>A atualização bayesiana define o processo de aprendizagem ótima no <em>pequeno mundo</em>, convertendo assim a priori em posteriori.</p></li>
<li><p>Vamos dar ao Golem uma informação sobre o estado, antes dele <em>ver</em> os dados: assim teremos uma crença inicial em cada possível valor de <span class="math notranslate nohighlight">\(p\)</span>, proporção de água na superfície da Terra, que deve estar entre <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>Condicionar os dados da amostra para atualizarmos o estado da informação: uma nova credibilidade em cada valor de <span class="math notranslate nohighlight">\(p\)</span>, condicionado aos dados.</p></li>
</ul>
<p>Basicamente iremos atualizar a informação excluindo todas as possibilidades que são impossíveis de acontecer dado os <code class="docutils literal notranslate"><span class="pre">dados</span> <span class="pre">amostrais</span></code> e, depois, contar todas as possibilidades.</p>
<p>Assim como no exemplo da bolsa, temos que atribuir as nossas hipóteses para conseguirmos avaliar quais delas são as mais plausíveis.</p>
<p>Para entermos melhor, vamos pensar em algumas hipóteses que são mais razoáveis:</p>
<div class="math notranslate nohighlight">
\[\mbox{Hipótese 1 :   } p = 0.50\]</div>
<div class="math notranslate nohighlight">
\[\mbox{Hipótese 2 :   } p = 0.60\]</div>
<div class="math notranslate nohighlight">
\[\mbox{Hipótese 3 :   } p = 0.70\]</div>
<div class="math notranslate nohighlight">
\[\mbox{Hipótese 4 :   } p = 0.80\]</div>
<div class="math notranslate nohighlight">
\[\mbox{Hipótese 5 :   } p = 0.90\]</div>
<p>Podemos fazer as contagens na mão para todas as <span class="math notranslate nohighlight">\(5\)</span> hipóteses propostas, assim como nós fizemos no exemplo das bolinhas na bolsa. Agora, pare um pouco, e realmente tire um tempo para refletir sobre o que estamos fazendo até agora.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sério! Não vá adiante sem compreender qual é a semelhança entre os dois exemplos!</p>
</div>
<p>Uma das perguntas que pode (e deveria ter surgido na sua mente) é a seguinte:</p>
<ul class="simple">
<li><p>Por que foram escolhidas essas cinco hipóteses?</p></li>
<li><p>Poderiamos ter escolhido <span class="math notranslate nohighlight">\(p = 0.65\)</span> ou <span class="math notranslate nohighlight">\(p = 0.67\)</span> ou ainda <span class="math notranslate nohighlight">\(p = 0.6211\)</span> ?</p></li>
</ul>
<p>Sim, poderiamos! Agora que entendemos o exemplo com as <span class="math notranslate nohighlight">\(5\)</span> hipóteses, podemos colocar outras hipóteses?</p>
<p>Quais outras <code class="docutils literal notranslate"><span class="pre">devemos</span></code> colocar?</p>
<div class="math notranslate nohighlight">
\[Todas!\]</div>
<p>Iremos colocar <code class="docutils literal notranslate"><span class="pre">todas</span> <span class="pre">computacionamente</span></code>, todos os números que estão entre <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Segue abaixo um gráfico das nossas <em>crenças iniciais</em>, da proporção de água na superfície da terra, para cada uma das hipóteses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A primeira hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># O valor 0.01 é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1)</span>

<span class="c1"># Plotando à priori, isto é, nossa crença inicial sobre a proporção de água na superfície da Terra.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da priori</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Priori, $p$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;plausibilidade&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_21_0.png" src="_images/parte_2_21_0.png" />
</div>
</div>
<p>Antes de lançarmos o globo para obtermos nossas amostras, iremos inserir no modelo nossa informação <em><code class="docutils literal notranslate"><span class="pre">à</span> <span class="pre">priori</span></code></em> sobre cada uma das hipóteses (<span class="math notranslate nohighlight">\(p\)</span>) que já discutimos anteriormente.</p>
<p><em>À priori</em> iremos considerar que todos os valores são igualmente plausíveis para todos os possíveis valores de <span class="math notranslate nohighlight">\(p\)</span>. Isto é, a linha tracejada no gráfico acima, nos indica que todos os valores entre <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span> tem a <code class="docutils literal notranslate"><span class="pre">mesma</span> <span class="pre">plausibilidade</span> <span class="pre">de</span> <span class="pre">ocorrer</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Podemos também imaginar que o nosso modelo servirá para qualquer um dos planetas do Universo, não apenas para o planeta Terra.</p>
</div>
<p><strong>Condições para esse Golem funcionar:</strong></p>
<ul class="simple">
<li><p>A ordem dos dados é <code class="docutils literal notranslate"><span class="pre">irrelevante</span></code>, pois o Golem assume que a ordem é irrelevante, assim podemos colocar os dados:</p>
<ul>
<li><p>Todos de uma só vez.</p></li>
<li><p>Cada um por vez.</p></li>
<li><p>Em ordem embaralhada, em qualquer quantidade, nos darão a mesma posteriori como resultados final.</p></li>
</ul>
</li>
</ul>
<p>Assim teremos também que:</p>
<ul class="simple">
<li><p>Toda a <code class="docutils literal notranslate"><span class="pre">posteriori</span></code> será a <code class="docutils literal notranslate"><span class="pre">priori</span> <span class="pre">para</span> <span class="pre">próxima</span> <span class="pre">observação</span></code>.</p></li>
<li><p>Cada priori é a posteriori de alguma outra inferência.</p></li>
<li><p>O <code class="docutils literal notranslate"><span class="pre">efeito</span> <span class="pre">do</span> <span class="pre">tamanho</span> <span class="pre">da</span> <span class="pre">amostra</span></code> está automaticamente incorporado na posteriori.</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="criticando-o-modelo">
<h1>Criticando o modelo<a class="headerlink" href="#criticando-o-modelo" title="Permalink to this headline">¶</a></h1>
<p>Agora temos que sair do <code class="docutils literal notranslate"><span class="pre">pequeno</span> <span class="pre">mundo</span></code> e fazer as inferências no <code class="docutils literal notranslate"><span class="pre">mundo</span> <span class="pre">real</span></code>. Devemos, com isso, sermos críticos com as características do modelo e dos dados. O <em>pequeno mundo</em> não é igual ao mundo real, portanto haverá divergências e devemos estar ciente e atentos para entender e reavaliar o modelo e os dados. Como por exemplo:</p>
<ul class="simple">
<li><p>Temos que observar como é feita a coleta dos dados e <code class="docutils literal notranslate"><span class="pre">se</span> <span class="pre">pode</span> <span class="pre">existir</span> <span class="pre">algum</span> <span class="pre">viés</span> <span class="pre">nesse</span> <span class="pre">processo</span></code>: como pessoas daltonicas ver cores diferentes no globo; se algum país tem a cor azul;</p></li>
</ul>
<ul class="simple">
<li><p><strong>Inferência bayesiana</strong>: é a resposta lógica para a problema que estamos modelando:</p></li>
<li><p><em>O quão plausível é cada proporção de água, dado os dados?</em></p></li>
<li><p>O Golem deve ser supervisionado verificando questões tais como:</p>
<ul>
<li><p>Golem apresenta mal funcionamento?</p></li>
<li><p>As respostas do Golem fazem sentido para o estudo em questão?</p></li>
<li><p>A questão que está sendo proposta faz sentido?</p></li>
<li><p>Checar se as mudanças nas suposições do modelo alteram a sensibilidade do mesmo?</p></li>
</ul>
</li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="construindo-o-framework-de-causalidade">
<h1>Construindo o framework de causalidade<a class="headerlink" href="#construindo-o-framework-de-causalidade" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="_images/casuality_proportional_water.png"><img alt="causal structure" src="_images/casuality_proportional_water.png" style="width: 400px;" /></a>
<p>Fonte: <a class="reference external" href="https://youtu.be/XoVtOAN0htU?t=1332">Assista no curso - Statistical Rethinking Course</a></p>
<p>Existe uma <code class="docutils literal notranslate"><span class="pre">relação</span> <span class="pre">causal</span> <span class="pre">na</span> <span class="pre">estrutura</span></code> na qual os dados são coletados, <span class="math notranslate nohighlight">\(W\)</span> depende apenas de <span class="math notranslate nohighlight">\(N\)</span> e de <span class="math notranslate nohighlight">\(p\)</span>. Mas o <span class="math notranslate nohighlight">\(N\)</span>, que significa a quantidade de amostras que coletamos, é independente tanto da proporção de água (<span class="math notranslate nohighlight">\(p\)</span>) quanto do número de amostras de água que foram coletadas (<span class="math notranslate nohighlight">\(W\)</span>).</p>
<p>Entretanto, temos que <span class="math notranslate nohighlight">\(N\)</span> e <span class="math notranslate nohighlight">\(W\)</span> são variáveis que observamos, e <span class="math notranslate nohighlight">\(p\)</span> a variável não-observada e que será inferida através das outras duas variáveis observadas pelo modelo.</p>
<p>Com essa mesma estrutura podemos, e também faremos mais adiante, a inferência sobre a quantidade de vezes que o globo foi lançado (<span class="math notranslate nohighlight">\(N\)</span>). Esse tipo de abordagem também é chamada <strong>modelo de captura-recaptura</strong>, estudado em principalmente em ecologia e em epidemiologia.</p>
<a class="reference internal image-reference" href="_images/mark_recapture.jpeg"><img alt="Recapture" src="_images/mark_recapture.jpeg" style="width: 800px;" /></a>
<hr class="docutils" />
<p><em>Mais informações sobre acesse:</em></p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mark_and_recapture">Wikipedia - Captura-Recaptura</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Talk:Mark_and_recapture#Statistical_treatment">Wikipedia - Tratamento Estatístico</a></p></li>
</ul>
<div class="section" id="definicao-de-w">
<h2>Definição de <em>W</em>:<a class="headerlink" href="#definicao-de-w" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>É o número relativo (proporcionais) de maneiras na quais podemos ver <span class="math notranslate nohighlight">\(W\)</span>, dado <span class="math notranslate nohighlight">\(N\)</span> e <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>Objetivo</strong>: Uma função matemática que atribui um <code class="docutils literal notranslate"><span class="pre">número</span> <span class="pre">relativo</span></code> de maneiras pelas quais veremos o valor específico de <em>W</em>, sem que precisarmos de construir todas as infinitas contagens relativas manualmente.</p></li>
<li><p><strong>Resposta</strong>: Distribuição de probabilidade.</p></li>
</ul>
<p>Para começar, vamos supor que coletamos 3 amostras:</p>
<div class="math notranslate nohighlight">
\[[W, L, W]\]</div>
<p>Qual é o número relativo (ou seja, proporcional) de maneiras de vermos essa sequência de amostras, dado algum valor de <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Não sabemos qual é o valor de <span class="math notranslate nohighlight">\(p\)</span>, mas iremos atribuir qualquer valor para o <span class="math notranslate nohighlight">\(p\)</span> que esteja entre <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Assim, temos uma probabilidade <span class="math notranslate nohighlight">\(p\)</span> de obter o primeiro valor igual a <span class="math notranslate nohighlight">\(W\)</span> e <span class="math notranslate nohighlight">\((1-p)\)</span> de obter <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>Multiplicaremos todas as proporções, pois os dados são independentes e mutualmente excludentes, assim pela teoria temos que as probabilidades são multiplicadas pela regra do produto.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Aqui será necessário entender o conceito de contagens!</p>
</div>
<p>E por que multiplicamos? Multiplicamos pois é a maneira mais rápida de contar todas as possibilidades pela bifurcação que o dados podem fazer. Não é nada de mais, é apenas um modo mais rápido e eficiênte de contar todas as possibilidades:</p>
<p>Por exemplo:</p>
<div class="math notranslate nohighlight">
\[ 5 \times 3 = 5 + 5 + 5 \]</div>
<p>Assim, teremos:</p>
<div class="math notranslate nohighlight">
\[ [W, L, W] \rightarrow p \times (1-p) \times p\]</div>
<div class="math notranslate nohighlight">
\[  = p^2 \times (1-p)^1 \]</div>
<p>Perceber também que nossa amostra poderá vir em duas outras <code class="docutils literal notranslate"><span class="pre">sequências</span> <span class="pre">diferentes</span></code>, que não mudará o resultado.</p>
<div class="math notranslate nohighlight">
\[ [W, W, L] \rightarrow p \times p \times (1-p) \]</div>
<div class="math notranslate nohighlight">
\[ [L, W, W] \rightarrow (1 - p) \times p \times p \]</div>
<p>Com isso, precisamos também contar todas as ordens possíveis de coletarmos uma amostra com <em>dois</em> <span class="math notranslate nohighlight">\(W\)</span> e <em>uma</em> <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>Então, nesse caso particular, a contagem relativa de maneiras de se obter essa amostra é:</p>
<div class="math notranslate nohighlight">
\[ 3 \times p^2 \times (1-p)^1 \]</div>
</div>
<div class="section" id="distribuicao-de-w-verossimilhanca">
<h2>Distribuição de W (<em>Verossimilhança</em>)<a class="headerlink" href="#distribuicao-de-w-verossimilhanca" title="Permalink to this headline">¶</a></h2>
<p>Com essa fórmula, se extrapolarmos a para uma amostra de qualquer comprimento (<span class="math notranslate nohighlight">\(N\)</span>), chegaremos a conhecida <code class="docutils literal notranslate"><span class="pre">Distribuição</span> <span class="pre">Binomial</span></code>. E sua forma geral é descrita pela fórmula abaixo:</p>
<div class="math notranslate nohighlight">
\[ P\{W | N, p\} = \frac{N!}{W! (N-W)!}  p^W  (1 - p)^{(N - W)} \]</div>
<p>A contagem relativa dos <span class="math notranslate nohighlight">\(W\)</span> é <em>distribuída binomialmente</em>, e com probabilidade <span class="math notranslate nohighlight">\(p\)</span> iremos sortear <span class="math notranslate nohighlight">\(W\)</span> de um total de <span class="math notranslate nohighlight">\(N\)</span> amostras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python Code - 2.2</span>

<span class="c1"># pmf</span>
<span class="c1"># Probability Mass Function = Função de massa de probabilidade</span>

<span class="c1"># Distribuição Binomial</span>
<span class="n">W_6_9</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A probabilidade de obtermos 6 W&#39;s em 9 amostras é de </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> com a probabilidade de 50</span><span class="si">% d</span><span class="s2">e encontrarmos um W em cada amostra.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">W_6_9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A probabilidade de obtermos 6 W&#39;s em 9 amostras é de 0.16406250000000003 
 com a probabilidade de 50% de encontrarmos um W em cada amostra.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="probabilidade-priori-p">
<h2>Probabilidade <em>Priori</em> (<span class="math notranslate nohighlight">\(p\)</span>)<a class="headerlink" href="#probabilidade-priori-p" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>É o que o nosso golem acredita antes de ‘<em>ver</em>’ os dados.</p></li>
<li><p>Nesse caso será a probabilidade à priori uniforme <span class="math notranslate nohighlight">\(0-1\)</span> para todos os <span class="math notranslate nohighlight">\(p\)</span>’s.</p></li>
<li><p><span class="math notranslate nohighlight">\(P\{W\}\)</span> e <span class="math notranslate nohighlight">\(P\{p\}\)</span> define nossa distribuição preditiva <em>à priori</em>.</p></li>
</ul>
<p><em>Preditiva</em> está relacionada com a ação de afirmar antecipadamente o que poderá ocorrer num momento futuro. Deduzido ou entendido a partir de informações, dados ou ações anteriores à finalização.*</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A primeira hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 0.01 é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span> 

<span class="c1"># Calculando a verosimilhança para todas nossas hipóteses de proporções de água para a primeira amostra.</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>

<span class="n">verossimilhanca_1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">]),</span>  <span class="c1"># A primeira amostra sorteada.</span>
                                    <span class="n">N</span><span class="p">,</span>  <span class="c1"># N é o número de amostras que estamos retirando. (Nesse caso, 1)</span>
                                    <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span>  <span class="c1"># É o vetor de probabilidades, ou seja, as são nossas hipóteses!</span>

<span class="c1"># Calculando a posteriori.</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca_1</span> <span class="o">*</span> <span class="n">priori</span>

<span class="c1"># Gerando o gráfico com a priori x primeira amostra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>  <span class="c1"># Plotando o gráfico da priori - (Cinza pontilhado)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plotando o gráfico da posteriori - (Azul) </span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Priori, $p$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Plausibilidade&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_37_0.png" src="_images/parte_2_37_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra</span>
<span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Precisão do Grid - Número de hipóteses que estamos testando (Grid Aproximation)</span>

<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># O precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Todos os elementos de nossas amostra</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numéricos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span> 

<span class="c1"># (Configurações técnicas para a plotagem dos gráficos).</span>
<span class="n">_lado</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">))))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">_lado</span><span class="p">,</span> <span class="n">_lado</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># Constrói um grade quadrada para alocar os gráficos gerados. </span>

<span class="n">posicao</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_lado</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_lado</span><span class="p">)]</span>  <span class="c1"># Gera todas as posicões da grade.</span>

<span class="c1"># Gerando uma posteriori para cada uma das hipóteses.</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)):</span>
    
    <span class="c1"># Calculando a verosimilhança para todas nossas hipóteses de proporções de água para a primeira amostra.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">n</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>

    <span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">]),</span>  <span class="c1"># Qtd de &#39;1&#39; na amostra.</span>
                                        <span class="n">N</span><span class="p">,</span>  <span class="c1"># N é o número de amostras que estamos retirando.</span>
                                        <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span>  <span class="c1"># É o vetor de probabilidades, nossas hipóteses.</span>

    <span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> 
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Plot da Priori</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> 
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amostra: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - $p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Plausibilidade&#39;</span><span class="p">)</span>    
    
    <span class="n">priori</span> <span class="o">=</span> <span class="n">posteriori</span>  <span class="c1"># Posteriori se torna à priori para a análise seguinte.</span>

    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Priori &amp; Posteriori, $p$&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_38_0.png" src="_images/parte_2_38_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 0.01 é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span> 


<span class="c1"># (Configurações técnicas para a plotagem dos gráficos).</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Gerando uma posteriori para cada uma das hipóteses.</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)):</span>
    
    <span class="c1"># Calculando a verosimilhança para todas nossas hipóteses de proporções de água para a primeira amostra.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">n</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>

    <span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">]),</span>  <span class="c1"># Qtd de &#39;1&#39; na amostra.</span>
                                        <span class="n">N</span><span class="p">,</span>  <span class="c1"># N é o número de amostras que estamos retirando.</span>
                                        <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span>  <span class="c1"># É o vetor de probabilidades, nossas hipóteses.</span>

    <span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Plot da Priori</span>

    <span class="n">priori</span> <span class="o">=</span> <span class="n">posteriori</span>  <span class="c1"># Posteriori se torna à priori para a análise seguinte.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Evolução das Amostras - $p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Plausibilidade&#39;</span><span class="p">)</span>   
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Priori &amp; Posteriori, $p$&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_39_0.png" src="_images/parte_2_39_0.png" />
</div>
</div>
<div class="section" id="definindo-uma-linguagem">
<h3>Definindo uma linguagem<a class="headerlink" href="#definindo-uma-linguagem" title="Permalink to this headline">¶</a></h3>
<p>Para melhorar a comunicação, vamos utilizar a seguinte notação matemática:</p>
<ul class="simple">
<li><p>Dizemos que a variável W é distribuída binomialmente:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[W \sim binomial(N, p)\]</div>
<ul class="simple">
<li><p>Dizemos que a variável p é distribuída uniformemente:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p \sim uniform(0, 1)\]</div>
</div>
</div>
<div class="section" id="probabilidade-a-posteriori">
<h2>Probabilidade à Posteriori<a class="headerlink" href="#probabilidade-a-posteriori" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>A estimativa bayesiana é sempre uma distribuição sobre os parâmetros, <span class="math notranslate nohighlight">\(P\{ parametros | dados\}\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ P\{p | W, N \} \]</div>
<p>O cálculo via o teorema de bayes:</p>
<div class="math notranslate nohighlight">
\[ P\{ p | W, N \} = \frac{ P\{W | N, p\} \times P\{ p \} } {\sum P\{W | N, p \} P\{p\}}, \forall p   \]</div>
<p>onde (<span class="math notranslate nohighlight">\(\forall p\)</span>) significa <em>para todo os <span class="math notranslate nohighlight">\(p\)</span>’s</em>.</p>
<div class="math notranslate nohighlight">
\[ \mbox{Posteriori} = \frac{\mbox{Probabilidade das variáveis observadas | $N, p$ } \times \mbox{Priori}} {\mbox{Constante de Normalização}}  \]</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="posteriori-priori-e-verossimilhanca">
<h1>Posteriori, Priori e Verossimilhança<a class="headerlink" href="#posteriori-priori-e-verossimilhanca" title="Permalink to this headline">¶</a></h1>
<p>Observamos no gráfico abaixo qual o comportamento da posteriori quando escolhemos diferentes prioris para <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Perceba que o comportamento da posteriori, em vermelho, é afetada pela escolha da priori.
Prestar atenção na magnetude do eixo das probabiliades (<em>eixo y</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 0.01 é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Verossimilhanças de todas as amostras.</span>
<span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">]),</span>  <span class="c1"># Qtd de &#39;1&#39; na amostra.</span>
                                  <span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">),</span>  <span class="c1"># N é o número de amostras que estamos retirando.</span>
                                  <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span>  <span class="c1"># É o vetor de probabilidades, nossas hipóteses.</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    
    
<span class="c1"># ======== Priori 1 ============</span>
<span class="c1"># Definindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Priori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">verossimilhanca</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">verossimilhanca</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Verossimilhanca.</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span> <span class="c1"># Calculando a posteriori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Priori&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;x Verossimilhança&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; ∝  Posteriori&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


<span class="c1"># ======== Priori 2 ============</span>
<span class="c1"># Definindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0.5, 1) </span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Priori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">verossimilhanca</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">verossimilhanca</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Verossimilhanca.</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span> <span class="c1"># Calculando a posteriori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Priori&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;x Verossimilhança&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; ∝  Posteriori&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


<span class="c1"># ======== Priori 3 ============</span>
<span class="c1"># Definindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># Laplace(0.4, 0.1) </span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Priori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">verossimilhanca</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">verossimilhanca</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Verossimilhanca.</span>

<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span> <span class="c1"># Calculando a posteriori</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Priori&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;x Verossimilhança&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; ∝ Posteriori&#39;</span><span class="p">)</span>    

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Priori x Verossimilhança ∝  Posteriori&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_43_0.png" src="_images/parte_2_43_0.png" />
</div>
</div>
<div class="section" id="calculo-da-posteriori">
<h2>Cálculo da Posteriori<a class="headerlink" href="#calculo-da-posteriori" title="Permalink to this headline">¶</a></h2>
<p>Não temos escolha a não ser calcular a posteriori, porém podemos calcular de algumas formar diferentes:</p>
<ul class="simple">
<li><p>Abordagem Analítica (Geralmente impossível - Usando Prioris Conjugadas)</p></li>
<li><p>Via grade de aproximação (Custo computacionalmente elevado)</p></li>
<li><p>Aproximação Quadrática - Também conhecida com <em>Aproximação de Laplace</em> (É limitada, como foi feita acima!)</p></li>
<li><p>Monte Carlo via Markov Chain MCMC (Intenso Computacionamente)</p></li>
</ul>
<div class="section" id="via-grade-de-aproximacao-grid-approximation">
<h3>Via Grade de Aproximação (<em>Grid Approximation</em>)<a class="headerlink" href="#via-grade-de-aproximacao-grid-approximation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>A probabilidade á posteriori é o produto normalizado das:</p>
<ul>
<li><p>probabilidade dos dados</p></li>
<li><p>probabilidade á priori</p></li>
</ul>
</li>
<li><p>A grade usa um número finito de pontos ao invés usar o espaço contínuo.</p></li>
<li><p>Essa abordagem é muito custosa quando temos multiplos parâmetros.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conforme o exemplo anterior, usamos o grid approximation para estimar a nossa posteriori, </span>
<span class="c1"># Abaixo, temos as precisões do grid.</span>
<span class="c1">#</span>
<span class="c1"># Para precisão mais baixa, o gráfico tende a ficar mais &#39;pixelizado&#39;, e se torna mais &#39;contínuo&#39; quando </span>
<span class="c1">#  aumentamos a precisão, visualmente, precisões acima de 100 não geram gráficos melhores. </span>

<span class="c1"># ========================================</span>
<span class="c1">#      Teste a diferença entre eles:       </span>
<span class="c1"># ========================================</span>
<span class="c1"># precisao_grid = 3                       </span>
<span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Apenas usado como um exemplo!                    </span>
<span class="c1"># precisao_grid = 10                        </span>
<span class="c1"># precisao_grid = 15 </span>
<span class="c1"># precisao_grid = 20 </span>
<span class="c1"># precisao_grid = 50 </span>
<span class="c1"># precisao_grid = 100 </span>
<span class="c1"># ========================================</span>

<span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span> 


<span class="c1"># (Configurações técnicas para a plotagem dos gráficos).</span>
<span class="n">_lado</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">))))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">_lado</span><span class="p">,</span> <span class="n">_lado</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># Constrói um grade quadrada para alocar os gráficos gerados. </span>

<span class="n">posicao</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_lado</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_lado</span><span class="p">)]</span>  <span class="c1"># Gera todas as posicões da grade.</span>

<span class="c1"># Gerando uma posteriori para cada uma das hipóteses.</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)):</span>
    
    <span class="c1"># Calculando a verosimilhança para todas nossas hipóteses de proporções de água para a primeira amostra.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">n</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>

    <span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">N</span><span class="p">]),</span>  <span class="c1"># Qtd de &#39;1&#39; na amostra.</span>
                                        <span class="n">N</span><span class="p">,</span>  <span class="c1"># N é o número de amostras que estamos retirando.</span>
                                        <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span>  <span class="c1"># É o vetor de probabilidades, nossas hipóteses.</span>

    <span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">priori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">priori</span><span class="p">),</span> 
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Plot da Priori</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">),</span> 
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># Insere uma grade com linhas verticais.</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amostra: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - $p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$p$, Proporção de Água ($W$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Plausibilidade&#39;</span><span class="p">)</span>    
    <span class="n">ax</span><span class="p">[</span><span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">posicao</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">priori</span> <span class="o">=</span> <span class="n">posteriori</span>  <span class="c1"># Posteriori se torna à priori para a análise seguinte.</span>

    
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Grid Approximation usando a precisão de &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">precisao_grid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;pontos&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_47_0.png" src="_images/parte_2_47_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="amostras-a-partir-da-posteriori">
<h1>Amostras a partir da Posteriori<a class="headerlink" href="#amostras-a-partir-da-posteriori" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Calcule ou aproxime a posteriori</p></li>
<li><p>Faça uma amostragem com reposição da posteriori</p></li>
<li><p>Calcular coisas com essa amostra</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># Para melhorar o efeito do scatter plot</span>

<span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span> 

<span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span> 
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Normalizando a posteriori</span>

<span class="c1"># Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Normalizando a Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posteriori&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Proporção de Água na superfície da Terra </span><span class="se">\n</span><span class="s1"> (Nossas Hipóteses, $p_s$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Densidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Amostragem da posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> 
<span class="n">amostra_posteriori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posteriori</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">amostra_posteriori</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amostra_posteriori</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Plot da Amostra Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Amostra a partir da Posteriori (acima)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantidade de Amostras&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Proporção de Água na superfície da Terra </span><span class="se">\n</span><span class="s1"> (Nossas Hipóteses, $p_s$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_49_0.png" src="_images/parte_2_49_0.png" />
<img alt="_images/parte_2_49_1.png" src="_images/parte_2_49_1.png" />
</div>
</div>
<div class="section" id="calculando-coisas-com-a-nossa-amostra-da-posteriori">
<h2>Calculando coisas com a nossa amostra da Posteriori<a class="headerlink" href="#calculando-coisas-com-a-nossa-amostra-da-posteriori" title="Permalink to this headline">¶</a></h2>
<p>Geralmente não usamos a distribuição à Posteriori propriamente, mas sim uma amostragem de sua distribuição. Assim podemos manipular e entender algumas informações de modo mais simples. Essa estratégia computacional será usada para praticamente todas as nossas análises como estatísticos bayesianos.</p>
<p>Com a amostra, temos total controle computacional de calcular e entender não só os resultados, mas também manipularmos a engrenagens internas do Golem.</p>
<p>Isso é um dos pontos principais que tornam a <code class="docutils literal notranslate"><span class="pre">abordagem</span> <span class="pre">bayesiana</span></code> superior aos métodos de <em>machine learning</em>, quando é necessário entender os motivos do resultado e não apenas saber um valor específico.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>O processo a seguir de manipulação é uma das coisas que torna a abordagem bayesiana
um dos melhores métodos para análise de dados. Podemos obter o conhecimento dos parâmetros!</p>
</div>
<p>Abaixo listamos algumas informações que queremos saber sobre a nossa análise:</p>
<ul class="simple">
<li><p>Quanto de probabilidade à posteriori está abaixo, acima ou entre valores específicos do parâmetro?</p></li>
<li><p>Qual o valor do parâmetro que contém 50%, 80% ou 95% da probabilidade posteriori? <em>Intervalos de “Confiança”</em>?</p></li>
<li><p>Qual o valores dos parâmetros que <strong>maximizam</strong> a probabilidade à posteriori? <strong>Minimiza</strong> a perda à posteriori? <em>Estimativa do pontos</em></p></li>
</ul>
<p>Nós que decidimos qual usar! Não há uma regra <code class="docutils literal notranslate"><span class="pre">infantil</span></code> para usarmos sempre <span class="math notranslate nohighlight">\(95\%\)</span> ou <span class="math notranslate nohighlight">\(99\%\)</span> de probabilidade. Essa escolha depende do grau de precisão que se pretende trabalhar.</p>
<p>Existem, em estatística, basicamente dois tipos de intervalos: <code class="docutils literal notranslate"><span class="pre">Intervalo</span> <span class="pre">de</span> <span class="pre">Percentil</span></code> e <code class="docutils literal notranslate"><span class="pre">HPDI</span></code> (<em>Highest posterior density intervals</em> - Ou seja, o maior intervalo da densidade posteriori)</p>
<p><strong>Intervalos de Percentil</strong>: São as áreas de cada região (<em>indicados para serem usados em distribuições simétricas</em>)</p>
<p><strong>HPDI</strong>: É o intervalo mais estreito possível que contém a massa de probabilidade.</p>
<hr class="docutils" />
<p>O que precisamos saber é que o intervalo é apenas um resumo, eles comprimem a informação, mas o que geralmente importa é o formato da posteriori, <code class="docutils literal notranslate"><span class="pre">não</span> <span class="pre">há</span> <span class="pre">nada</span> <span class="pre">nos</span> <span class="pre">limites</span> <span class="pre">que</span> <span class="pre">geram</span> <span class="pre">o</span> <span class="pre">intervalos</span> <span class="pre">que</span> <span class="pre">tenha</span> <span class="pre">propriedades</span> <span class="pre">mágicas</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># Para melhorar o efeito do scatter plot</span>

<span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>
<span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span> 
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Normalizando a posteriori</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">probability_posteriori</span><span class="p">(</span><span class="n">hipoteses</span><span class="p">,</span> <span class="n">posteriori</span><span class="p">,</span> <span class="n">param_sup</span><span class="p">,</span> <span class="n">param_inf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">qtd_amostra</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_text</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Função que retorna a quantidade de pontos proporcionais (p) dentro um range&quot;&quot;&quot;</span>
    
    <span class="c1"># Calculando o tamanho da amostra da posteriori</span>
    <span class="n">amostra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">qtd_amostra</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posteriori</span><span class="p">)</span>
    
    <span class="c1"># Quantidade de pontos da amostra da posteriori que são maiores do que o parâmetro_1 </span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">amostra</span> <span class="o">&lt;=</span> <span class="n">param_sup</span>
    
    <span class="c1"># Se o parâmetro inferiori foi passado.</span>
    <span class="k">if</span> <span class="n">param_inf</span> <span class="ow">and</span> <span class="n">param_inf</span> <span class="o">&lt;</span> <span class="n">param_sup</span><span class="p">:</span>
        <span class="n">prob_param_inf</span> <span class="o">=</span> <span class="n">amostra</span> <span class="o">&gt;=</span> <span class="n">param_inf</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">prob</span> <span class="o">*</span> <span class="n">prob_param_inf</span>  <span class="c1"># Juntando ambas contagens do param_1 e do param_2</span>
        
    <span class="c1"># Configurações do plot</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">hipoteses_filtrado_superior</span> <span class="o">=</span> <span class="n">hipoteses</span> <span class="o">&lt;=</span> <span class="n">param_sup</span>  <span class="c1"># Todas as hipóteses que são menores que param_sup</span>
        
        <span class="c1"># Se o parâmetro inferiori foi passado.</span>
        <span class="k">if</span> <span class="n">param_inf</span><span class="p">:</span>
            <span class="n">hipoteses_filtrado_inferior</span> <span class="o">=</span> <span class="n">hipoteses</span> <span class="o">&gt;=</span> <span class="n">param_inf</span>
            <span class="n">posteriori_filtrada</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">*</span> <span class="n">hipoteses_filtrado_superior</span> <span class="o">*</span> <span class="n">hipoteses_filtrado_inferior</span>
            <span class="n">texto</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Probabilidade da proporção de água (p) na superfície da Terra estar </span><span class="se">\n</span><span class="s1"> entre &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_inf</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; e &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_sup</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; é igual à &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostra</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;%, dado a amostra.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">posteriori_filtrada</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">*</span> <span class="n">hipoteses_filtrado_superior</span>
            <span class="n">texto</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Probabilidade da proporção de água (p) na superfície da Terra estar </span><span class="se">\n</span><span class="s1"> entre 0 e &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_sup</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; é igual à &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostra</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;%, dado a amostra.&#39;</span><span class="p">)</span>
             
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hipoteses</span><span class="p">,</span> <span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Plot posteriori</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">hipoteses</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">posteriori_filtrada</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Probabilidade das hipóteses da superfície da Terra estar coberta por água&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hipóteses, $p_s$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Posteriori&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">show_text</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">texto</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostra</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Probabilidade da proporção da superfície de Terra estar entre parâmtros abaixo:</span>

<span class="c1"># =======================================================</span>
<span class="c1">#         Configure os p_s superiores e inferiores</span>
<span class="c1"># -------------------------------------------------------</span>

<span class="n">parametro_p_inferior</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># [0, 1] or False</span>

<span class="n">parametro_p_superior</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># [0, 1]</span>

<span class="c1"># =======================================================</span>

<span class="c1"># Chamando a função probability_posteriori com plot=True</span>
<span class="n">probability_posteriori</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span><span class="p">,</span> <span class="n">param_inf</span><span class="o">=</span><span class="n">parametro_p_inferior</span><span class="p">,</span> <span class="n">param_sup</span><span class="o">=</span><span class="n">parametro_p_superior</span><span class="p">,</span> <span class="n">show_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_56_0.png" src="_images/parte_2_56_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Probabilidade da proporção de água (p) na superfície da Terra estar 
 entre 0.5 e 0.7 é igual à 48%, dado a amostra.
</pre></div>
</div>
</div>
</div>
<p>Nós normalmente não usamos estimativas pontuais para tomar decisões como outras escolas estatísticas tendem a pensar. Se assim fosse, era como se tivéssemos colocando toda a certeza num só ponto (<span class="math notranslate nohighlight">\(\theta = 0,63\)</span>, por exemplo) ou, pelo menos, escolhendo o valor que maximiza a probabilidade (<span class="math notranslate nohighlight">\(\theta = 0,63\)</span>, por exemplo) mas ainda ignorando todos os outros possíveis valores viáveis.</p>
<p>Assim a proposta bayesiana tem as seguintes considerações:</p>
<ul class="simple">
<li><p>A Posteriori inteira contém toda a informação!</p></li>
<li><p>O melhor ponto depende, sempre, da proposta.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">média</span></code> quase sempre é mais sensível do que a <code class="docutils literal notranslate"><span class="pre">moda</span></code>.</p></li>
</ul>
</div>
<div class="section" id="falando-um-pouco-sobre-intervalos">
<h2>Falando um pouco sobre intervalos<a class="headerlink" href="#falando-um-pouco-sobre-intervalos" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Intervalo de Confiança</strong>:</p>
<ul>
<li><p>Esse é um termo não bayesiano que <code class="docutils literal notranslate"><span class="pre">nem</span> <span class="pre">sempre</span> <span class="pre">significa</span> <span class="pre">o</span> <span class="pre">que</span> <span class="pre">diz</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Intervalo de credibilidade</strong>:</p>
<ul>
<li><p>Não devemos acreditar na credibilidade <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">menos</span> <span class="pre">que</span> <span class="pre">acreditemos</span> <span class="pre">nos</span> <span class="pre">dados</span> <span class="pre">e</span> <span class="pre">no</span> <span class="pre">modelo</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="section" id="checagem-da-predicao-do-modelo">
<h3>Checagem da predição do modelo<a class="headerlink" href="#checagem-da-predicao-do-modelo" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>A probabilidade à posteriori nunca é suficiente.</p></li>
<li><p>Até os melhores modelos podem fazer predições terríveis.</p></li>
<li><p>Nós também devemos sempre checar as suposições do modelo.</p></li>
<li><p><strong>Checagem preditiva</strong>: Podemos usar amostras da posteriori para analisar as observações da simuladas.</p></li>
</ul>
</div>
<div class="section" id="vamos-entender-como-fazer-simulacoes-a-partir-da-posteriori">
<h3>Vamos entender como fazer simulações a partir da posteriori<a class="headerlink" href="#vamos-entender-como-fazer-simulacoes-a-partir-da-posteriori" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># Para melhorar o efeito do scatter plot</span>

<span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>
<span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span> 
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Normalizando a posteriori</span>

<span class="c1"># Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">posteriori</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot da Posteriori</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">max_posteriori</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1</span>  <span class="c1"># Proposta de um tamanho da barra horizontal</span>

<span class="c1"># Plotando 3 pontos verticais</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_posteriori</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Ponto 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_posteriori</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Ponto 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_posteriori</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Ponto 3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posteriori&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Proporção de Água na superfície da Terra </span><span class="se">\n</span><span class="s1"> (Nossas Hipóteses ($p_s$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Densidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_63_0.png" src="_images/parte_2_63_0.png" />
</div>
</div>
<p>Nossas três <code class="docutils literal notranslate"><span class="pre">estimativas</span> <span class="pre">pontuais</span></code> de <span class="math notranslate nohighlight">\(p\)</span> serão colocadas na distribuição binomial e iremos obter a forma da distribuição desse parâmetro, com <span class="math notranslate nohighlight">\(N=9\)</span> elementos sorteados.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Explicação mais matemática abaixo!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Usando $p=0.3$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilidade&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$W$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Usando $p=0.5$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$W$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Usando $p=0.9$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$W$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Distribuição Binomial </span><span class="se">\n</span><span class="s1"> ($N=9$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_65_0.png" src="_images/parte_2_65_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gerando a distribuição preditiva binomial com amostras de p da posteriori</span>

<span class="n">precisao_grid</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># Para melhorar o efeito do scatter plot</span>

<span class="c1"># Gerando todas as hipóteses sobre a proporção de água sobre a superfície da Terra.</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">precisao_grid</span><span class="p">)</span>  <span class="c1"># precisao_grid é um ajuste para o vetor de p_s = [0, 1] </span>

<span class="c1"># Construindo uma Priori.</span>
<span class="n">priori</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># uniforme(0, 1) </span>

<span class="c1"># Amostra.</span>
<span class="n">amostras</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">]</span>

<span class="c1"># Transformando nossa amostra em valores numericos.</span>
<span class="n">amostras_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">amostra</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">amostra</span> <span class="ow">in</span> <span class="n">amostras</span><span class="p">]</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">amostras</span><span class="p">)</span>  <span class="c1"># É a variável que determina o tamanho da amostra que estamos utilizando no momento.</span>
<span class="n">verossimilhanca</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">amostras_num</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_s</span><span class="p">)</span> 
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">verossimilhanca</span> <span class="o">*</span> <span class="n">priori</span>  <span class="c1"># Calculando a posteriori.</span>
<span class="n">posteriori</span> <span class="o">=</span> <span class="n">posteriori</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">posteriori</span><span class="p">)</span>  <span class="c1"># Normalizando a posteriori</span>

<span class="n">amostra</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">p_amostrado</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p_s</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posteriori</span><span class="p">)</span>
    <span class="n">amostra_binomial</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_amostrado</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># 100 amostras para cada p_amostrado</span>
    <span class="n">amostra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amostra_binomial</span><span class="p">)</span>
    
<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">amostra</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$w$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probabilidade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribuição de Posteriori Preditiva </span><span class="se">\n</span><span class="s1"> ($Binominal$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/parte_2_66_0.png" src="_images/parte_2_66_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="resumo">
<h1>Resumo<a class="headerlink" href="#resumo" title="Permalink to this headline">¶</a></h1>
<p>Achei interessante fazer um resumo mais matemático para eu conseguir alinhar as minhas ideias, essa parte não está  diretamente no conteúdo original dessa aula. Não necessário ler essa parte para continuar.</p>
<hr class="docutils" />
<p>A distribuição binomial é uma função matemática comum do ponto de vista algébrico. Ela tem como três parâmetros, (<span class="math notranslate nohighlight">\(N, W, p\)</span>), e que retorna a probabilidade de ocorrer esse determinado evento!</p>
<p>Ná anáĺise de dados, quais são as variáveis que normalmente temos?</p>
<ul class="simple">
<li><p>N = Quantidade de amostra (count no banco de dados?)</p></li>
<li><p>W = Quantas vezes que ocorreu o sucesso?</p></li>
</ul>
<p>Mas ainda nos falta saber qual o <span class="math notranslate nohighlight">\(p\)</span>? Se tivessêmos o <span class="math notranslate nohighlight">\(p\)</span>, poderiamos calcular a probabilidade da binomial!</p>
<p>Mas o <span class="math notranslate nohighlight">\(p\)</span> é justamente o valor que eu quero obter mais conhecimento.</p>
<p>Então podemos definir a verossimilhança da seguinte forma:</p>
<ul class="simple">
<li><p>Separar todos os <span class="math notranslate nohighlight">\(p\)</span> que forem plausíveis, ou seja, as minhas hipóteses.</p></li>
<li><p>Inserir a sua crença como um peso para todos os <span class="math notranslate nohighlight">\(p\)</span>’s separados anteriormente, ou seja, uma distribuição de probabilidades para os <span class="math notranslate nohighlight">\(p\)</span>’s. Essa é à priori.</p></li>
<li><p>Calcular para cada <span class="math notranslate nohighlight">\(p\)</span>’, que foi separado no primeiro passo, qual é a probabilidade da binomial usando os <span class="math notranslate nohighlight">\(N, W\)</span> e os <span class="math notranslate nohighlight">\(p\)</span>’s. A escolha do <span class="math notranslate nohighlight">\(p\)</span>’ que tem associada a máxima probabilidade, chamaremos de máxima verossimilhança. Para todos os <span class="math notranslate nohighlight">\(p\)</span>’s temos uma probabilidade associada. Perceba soma da probabilidade de todos os <span class="math notranslate nohighlight">\(p\)</span>’s podem não somar <span class="math notranslate nohighlight">\(1\)</span>. Pois elas são, individualmente, apenas a probabilidade da distribuição binonial com o parâmetros <span class="math notranslate nohighlight">\(N, W\)</span> e <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
<p>Chama-se <code class="docutils literal notranslate"><span class="pre">verossimilhança</span></code>, em linguagem coerente ao atributo daquilo que parece intuitivamente verdadeiro, isto é, o que é atribuído a uma realidade portadora de uma aparência ou de uma probabilidade de verdade, na relação ambígua que se estabelece entre imagem e ideia.</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">verossimilhança</span></code> ponderada (<em>multiplicado</em>) pela nossa distribuição <code class="docutils literal notranslate"><span class="pre">priori</span></code>, é a <code class="docutils literal notranslate"><span class="pre">posteriori</span></code>!</p></li>
</ul>
<p>Então o gráfico anterior, com 3 cores, é quando fixo um <span class="math notranslate nohighlight">\(p\)</span> específico e não uso mais o valor obtido da amostra <span class="math notranslate nohighlight">\(W\)</span>, mas faço o cálculo da probabilidade de ocorrer cada um dos possíveis valores de <span class="math notranslate nohighlight">\(W\)</span> dado <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>E, por fim, para gerar a distribuição preditiva é necessário fazer a amostragem dos <span class="math notranslate nohighlight">\(p\)</span>’s e com eles gerar da distribuição preditiva amostras. O último gráfico faz isso e gera a probabilidade de, com <span class="math notranslate nohighlight">\(9\)</span> lançamentos (<span class="math notranslate nohighlight">\(n=9\)</span>), qual é a probabilidade de todos os possíveis valores de <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="parte_1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">1- Introdução</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="parte_3.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3- Modelos Geocêntricos</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Rodolpho Macedo dos Santos<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>